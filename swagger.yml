---
openapi: 3.1.0

servers:
  - url: https://sender.api.kivra.com
    description: Production environment
  - url: https://sender.sandbox-api.kivra.com
    description: Sandbox environment
info:
  title: Kivra Sweden API
  x-logo:
    url: "assets/Kivra_logo_1920X1080_green.png"
    altText: Kivra logo # don't rename this without fixing assets/redoc-styles.css
  description:
    $ref: "./_partials/api-introduction.yml#/introText"

tags:
  - name: "Tenant API - Content"
    description: Endpoints for matching users and sending content
  - name: "Tenant API - Forms"
    description: |
      Endpoints for working with form templates and responses
  - name: "Tenant API - Registered letters"
    description: |
      Endpoints for fetching and removing registered letter responses.

      A registered letter ensures secure delivery by requiring the recipient to sign before viewing the letter's content, providing proof of receipt.

      The responses can later be collected and removed by the sender.
  - name: "Tenant API - Tickets (BETA)"
    description: |
      **Note that this feature is not yet available. It will become available in June 2026.**
  - name: "Tenant API - Tenant Management"
    description: Endpoints for creation and administration of tenants (v2)
  - name: "Tenant API - Agreements"
    description: Endpoints for managing signatures and agreements
  - name: "Tenant API - Payment Webhooks"
    description: |
      Endpoints used to set up, list and remove webhook definitions, and webhook payloads.
  - name: "Partner API v1"
    description: |
      Endpoints for partner access to company mailboxes.
  - name: "Partner API v3"
    description: |
      # Webhook - Authentication
      When Kivra sends webhook requests to your endpoint, you need to verify that
      these requests are genuine and come from Kivra. The webhook authentication
      scheme is based on HMAC signatures with a shared secret.

      For each webhook request, Kivra includes the following HTTP headers:

      ```
      X-KIVRA-TIMESTAMP: <timestamp>
      X-KIVRA-SIGNATURE: v1=<signature>
      ```

      Where `<timestamp>` is the Unix timestamp in seconds when the webhook
      delivery attempt was made (UTC), and `<signature>` is our HMAC (see
      below).

      Kivra will send one signature header per secret in rotation. This is to
      allow zero downtime key rotation.

      ```
      X-KIVRA-TIMESTAMP: <timestamp>
      X-KIVRA-SIGNATURE: v1=<signature1>
      X-KIVRA-SIGNATURE: v1=<signature2>
      ```

      To verify a webhook request:

      1. Extract the timestamp `t` from the `X-KIVRA-TIMESTAMP` header
      2. Verify the timestamp is within your acceptable time drift tolerance to
         prevent replay attacks
      3. Prepare the message string: `message = t + ":" + request_body` (the raw
         request body)
      4. Compute a SHA-256 HMAC using your shared secret: `signature =
         HMAC-SHA256(message, shared_secret)`
      5. Compare the generated signature with each signature in the
         `X-KIVRA-SIGNATURE` headers
      6. If ANY signature matches, the request is authentic

      The receiver determines what time drift is acceptable. Requests with
      timestamps outside this tolerance should be rejected to prevent replay
      attacks.

      # Webhook - Event payload
      The webhook payload is a JSON object with the following fields:

      - `id`: Unique identifier for the event. Guaranteed to stay the same
        between retries, and therefore can be used to deduplicate events.
      - `event_created_at`: unix timestamp in seconds when the event happened
        (UTC). This will stay the same even when retried. See the
        `X-KIVRA-TIMESTAMP` header for the time the event was sent.
      - `event_type`: a tag describing what happened, e.g. "content.created".
      - `data_version`: the version of `data` being sent.
      - `data`: the `event_type` specific data.

      The `event_type` and `data_version` together determine the shape of the
      `data` field. Backwards compatible changes, such as addtions of new
      fields, will not increment the `data_version`. However, for breaking
      changes `data_version` will be incremented. In practice this means you
      must be able to handle extra fields.

      ```jsonc
      {
        "id": "event_3f62fc97907a4212af028c30f1ea1927",
        "event_created_at": 1686089970,
        "event_type": "content.created",
        "data_version": 1,
        "data": {
          // Event-specific payload
        }
      }
      ```

      # Webhook - Responding
      The response must be a 200 OK or Kivra will retry a little while later.
      This means Kivra can only gurantee a "at-least-once" delivery and it is up
      to you do handle duplicated events. To make this a bit easier Kivra will
      use the same `event_id` for every retry.

      Note that `event_created_at` and `X-KIVRA-TIMESTAMP` are unrelated. The
      former is set when the event happened, the latter for each attempt.

x-tagGroups:
  - name: Tenant API
    tags:
      - "Tenant API - Content"
      - "Tenant API - Forms"
      - "Tenant API - Registered letters"
      - "Tenant API - Tickets (BETA)"
      - "Tenant API - Tenant Management"
      - "Tenant API - Agreements"
      - "Tenant API - Payment Webhooks"
  - name: Partner API
    tags:
      - "Partner API v1"
      - "Partner API v3"

paths:
  /vX/hamburger:
    get:
      summary: Get your burger
      operationId: Get your burger
      description: Get your free hamburger
      security:
        - oAuth2Client:
            - "get:kivra.vX.hamburger"
      responses:
        200:
          description: empty response confirming that the put operation was successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  variant:
                    type: string
                    example: "Royale with Cheese"

  # ##############################################
  # POST, GET /v2/tenant
  # ##############################################
  /v2/tenant:
    post:
      tags:
        - "Tenant API - Tenant Management"
      summary: Create Tenant
      operationId: Create Tenant (v2)
      description: |
        Creation of tenants via API allows clients to create new tenants in an efficient manner. The created tenant is automatically added to the client scope. The client needs to re-authenticate to have the new scope in effect.
        <aside class="notice">
        Note: Creation of tenants via API is only allowed in certain specific cases and its usage needs to be regulated in the business relationship between the sender party and Kivra.
        </aside>
      security:
        - oAuth2Client:
            - "post:kivra.v2.tenant"
      responses:
        200:
          description: |
            Tenant already existing and added to the client scope
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Tenant_v2"
          headers:
            kivra-objkey:
              description: Tenant Key
              schema:
                type: string
                format: "hexadecimal value"
            location:
              description: URL to created Object
              schema:
                type: string
                format: url
        201:
          description: |
            Tenant Created succesfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Tenant_v2"
          headers:
            kivra-objkey:
              description: Tenant Key
              schema:
                type: string
                format: "hexadecimal value"
            location:
              description: URL to created Object
              schema:
                type: string
                format: url
        409:
          description: |
            The tenant could not be created because of a conflict, meaning that a tenant with the same `orgnr` already exists and cannot be automatically added to the client scope. The client may use the `request_access` endpoint to request access to this tenant.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error40915"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Tenant_v2"
    get:
      tags:
        - "Tenant API - Tenant Management"
      summary: List tenants
      operationId: List all tenants accessible to the client
      description: Lists all tenants that are manageable by the current client
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant"
      parameters:
        - name: orgnr
          in: query
          description: Perform a search to see if a specific Company is available
          required: false
          schema:
            description: Companies unique Vat Number
            type: string
            example: SE556840226601
      responses:
        200:
          description: |
            List of available users
          content:
            application/json:
              schema:
                type: array
                description: List of tenants, can be empty
                items:
                  type: object
                  properties:
                    key:
                      type: string
                      description: Tenant ID
                  example:
                    [
                      { "key": "155748793356fa20e402ae472e51019cf723d7fe35" },
                      { "key": "150231793356fa88a88eae472e51019cf723d7d13a" },
                    ]

  # ##############################################
  # GET /v2/tenant/TKEY
  # ##############################################
  /v2/tenant/{tenantKey}:
    get:
      tags:
        - "Tenant API - Tenant Management"
      summary: Tenant information
      operationId: Get information on tenant
      description: Get detailed information on a tenant
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}"
      responses:
        200:
          description: |
            Tenant information
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Tenant_v2"

  # ##############################################
  # PUT /v2/tenant/TKEY/name
  # ##############################################
  /v2/tenant/{tenantKey}/name:
    put:
      tags:
        - "Tenant API - Tenant Management"
      summary: Update tenant name
      operationId: Update tenant name
      description: Update display name for the tenant. The updated name will be visible to the end-users only after they have received a new content.
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      security:
        - oAuth2Client:
            - "put:kivra.v2.tenant.{tenantKey}.name"
      responses:
        200:
          description: empty response confirming that the put operation was successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: "Lenas Konditori AB"

  # ##############################################
  # POST /v2/tenant/TKEY/company_id
  # ##############################################
  /v2/tenant/{tenantKey}/company_id:
    post:
      tags:
        - "Tenant API - Tenant Management"
      summary: Associate company ID to tenant
      operationId: Add company ID
      description: |
        Add a new company ID for a tenant. A tenant can be associated with one or more company ids (Vat number and company name)
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      security:
        - oAuth2Client:
            - "post:kivra.v2.tenant.{tenantKey}.company_id"
      responses:
        204:
          description: empty response confirming that the post operation was successful
        409:
          description: Another tenant with the same `orgnr` already exists.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error40915"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                company_id:
                  $ref: "#/components/schemas/CompanyId"

  # ##############################################
  # DELETE /v2/tenant/TKEY/company_id/{orgnr}
  # ##############################################
  /v2/tenant/{tenantKey}/company_id/{orgNr}:
    delete:
      tags:
        - "Tenant API - Tenant Management"
      summary: Delete company ID from tenant
      operationId: Delete company ID
      description: |
        Delete a  company ID from a tenant. A tenant can be associated with one or more company ids (Vat number and company name)
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: orgNr
          in: path
          description: The VAT number of the company_id to be removed from the tenant, for instance `SE556840226601`
          required: true
          schema:
            type: string
            format: hexadecimal
      security:
        - oAuth2Client:
            - "delete:kivra.v2.tenant.{tenantKey}.company_id.{orgnr}"
      responses:
        204:
          description: empty response confirming that the put operation was successful

  # ##############################################
  # POST /v2/tenant/TKEY/icon
  # ##############################################
  /v2/tenant/{tenantKey}/icon:
    post:
      tags:
        - "Tenant API - Tenant Management"
      summary: Provide an icon for a tenant
      operationId: Provide icon
      description: |
        Add or update the tenant icon. If an icon already exists, it will be changed.

        To check the current icon associated to a tenant you can simply check the following address:

        * sandbox: https://sandbox-static.kivra.com/img/tenant/{tenantKey}/icon.png
        * production: https://static.kivra.com/img/tenant/{tenantKey}/icon.png

        The icon needs to be provided according to the following format:

        * Dimensions: squared icon with size between 256x256 px and 512x512 px
        * Alpha Channel: 32-bits
        * Format: PNG
        * File size: up to 1MB

        We recommend to leave a little white area around the logo, to provide the best experience for the users.
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      security:
        - oAuth2Client:
            - "post:kivra.v2.tenant.{tenantKey}.icon"
      responses:
        204:
          description: empty response confirming that the put operation was successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                file:
                  $ref: "#/components/schemas/Icon"
            example:
              {
                "file": {
                  "name": "fancy icon",
                  "data": "REVBR ...... EJFRUY=",
                  "content_type": "image/png",
                },
              }

  # ##############################################
  # POST /v2/tenant/request_access
  # ##############################################
  /v2/tenant/request_access:
    post:
      tags:
        - "Tenant API - Tenant Management"
      summary: Request access to a tenant
      operationId: Request access
      description: |
        Request access to an existing tenant that is outside the client scope. Typically this request follows an unsuccessful attempt to create a tenant that resulted in a conflict error (error 409).

        The meaning of the conflict error is that a tenant is already associated to a `company_id` including the same `orgnr` as in the tenant that the client attempted to post, and the tenant who owns the `orgnr` is outside the scope for the client.

        In Kivra, it is allowed to have several different flows on the same tenant, for example one flow for invoices and another flow for salary slips. As these flows could be managed by different clients, we need a mechanism to allow sharing a tenant between clients.
        The `request_access` endpoint provide this functionality. As the request may be granted (or denied) asynchronously, after a successfull call to `request_access` the client will need to poll the request until it becomes `accepted` or `rejected`.

        As allowing access to a new tenant requires modification of the scope for the client, an authorization must be performed once the request has been accepted, to retrieve an access token with the new scope.

        If the client posts a new identical request (requesting the same `OrgNr` for the same client), the same object will be returned with an updated status.
      security:
        - oAuth2Client:
            - "post:kivra.v2.tenant.request_access"
      responses:
        201:
          description: Data about the requested tenant
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RequestAccess"
          headers:
            kivra-objkey:
              description: Object Key for the Request (requestKey)
              schema:
                type: string
                format: "hexadecimal value"
            location:
              description: The complete API url for where to check the status of this request
              schema:
                type: string
                format: "hexadecimal value"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                vat_number:
                  type: string
                  example: "SE556840226601"

  # ##############################################
  # GET /v2/tenant/request_access/{requestKey}
  # ##############################################
  /v2/tenant/request_access/{requestKey}:
    get:
      tags:
        - "Tenant API - Tenant Management"
      summary: Status of an access request
      operationId: Request access status
      description: |
        Gets the updated status for a request generate using the `request_access` endpoint.
      parameters:
        - name: requestKey
          in: path
          description: The unique Key for a request
          required: true
          schema:
            type: string
            format: hexadecimal
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.request_access.{requestKey}"
      responses:
        200:
          description: Data about the requested tenant
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RequestAccess"
          headers:
            kivra-objkey:
              description: Object Key for the Request
              schema:
                type: string
                format: "hexadecimal value"


  # ##############################################
  # POST v2 usermatching
  # ##############################################
  /v2/tenant/{tenantKey}/usermatch/ssn:
    post:
      tags:
        - "Tenant API - Content"
      summary: Match a list of ssns to recipient for a specific tenant (v2)
      operationId: Match Users ssn v2
      description: |
        This resource is used to match a list of users to check that they are eligible for receiving Content from the specific Tenant.
        The request contains a list of recipient SSNs to be matched, and the response is a filtered list containing only the SSNs
        that are eligible to receive content from the tenant.
        <aside class="notice">
          If none of the provided SSNs are eligible to receive content from this tenant, an empty list will be returned.
        </aside>
      parameters:
        - name: tenantKey
          in: path
          description: The tenant key the matching should be done against. Recipients that opt-out from the tenant will be excluded.
          required: true
          schema:
            type: string
            format: hexadecimal
      requestBody:
        description: |
          List of SSNs to be matched. The payload can be up to 10MB in size, corresponding to about 500.000 SSNs.
          If the payload exceeds 10MB, Kivra will respond with a 413 error.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserMatchV2SSN"
            example:
              list: ["191212121212", "197701032380", "198112172385"]
        required: true
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}.usermatch.ssn"
      responses:
        200:
          description: Filtered list of SSNs that matched.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserMatchV2SSN"
              example:
                list: ["191212121212", "198112172385"]

  /v2/tenant/{tenantKey}/usermatch/verified_email:
    post:
      tags:
        - "Tenant API - Content"
      summary: Match a list of emails to recipients for a specific tenant (v2)
      operationId: Match Users verified_email v2
      description: |
        This resource is used to match a list of users to check that they are eligible for receiving Content from the specific Tenant.
        The request contains a list of recipient email addresses to be matched, and the response is a filtered list containing only the
        email addresses that are eligible to receive content from the tenant.
        Email matching is case insensitive, but the queried email case is returned as submitted.
        <aside class="notice">
          If none of the provided email addresses are eligible to receive content from this tenant, an empty list will be returned.
        </aside>
      parameters:
        - name: tenantKey
          in: path
          description: The tenant key the matching should be done against. Recipients that opt-out from the tenant will be excluded.
          required: true
          schema:
            type: string
            format: hexadecimal
      requestBody:
        description: |
          List of email addresses to be matched. The payload can be up to 10MB in size.
          If the payload exceeds 10MB, Kivra will respond with a 413 error.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserMatchV2Email"
            example:
              list: ["fOO@example.com", "bAr@EXAMPLE.COM", "XYZ@example.COM"]
        required: true
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}.usermatch.verified_email"
      responses:
        200:
          description: Filtered list of email addresses that matched.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserMatchV2Email"
              example:
                list: ["fOO@example.COM", "bAr@EXAMPLE.COM"]

  /v2/tenant/{tenantKey}/companymatch/vatnr:
    post:
      tags:
        - "Tenant API - Content"
      summary: Match a list of VAT numbers to recipients for a specific tenant (v2)
      operationId: Match Companies VatNr v2
      description: |
        This resource is used to match a list of Companies to check that they are eligible for receiving Content from a specific Tenant.
        The request contains a list of VAT numbers to be matched, and the response is a filtered subset of said list containing only those VAT numbers matching a Company Recipient for which the Tenant is eligible to send Content to.
        <aside class="notice">
          If none of the provided VAT numbers match a Recipient eligible to receive content from the given Tenant, an empty list will be returned.
        </aside>
      parameters:
        - name: tenantKey
          in: path
          description: The Tenant key that the matching should be done on behalf of.
          required: true
          schema:
            type: string
            format: hexadecimal
      requestBody:
        description: |
          List of VAT numbers to be matched. The payload can be up to 10MB in size, corresponding to about 500.000 VAT numbers.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CompanyMatchSet"
            example:
              list: ["SE559408724801", "SE556917354401", "SE556840226601"]
        required: true
      security:
        - oAuth2Client:
            - "post:kivra.v2.tenant.{tenantKey}.companymatch.vatnr"
      responses:
        200:
          description: Filtered list of VAT numbers that matched.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CompanyMatchSet"
              example:
                list: ["SE556840226601", "SE559408724801"]
        413:
          description: Payload exceeded 10MB — try splitting into multiple calls instead.

  /v2/tenant/{tenantKey}/companymatch/vatnr_with_active_partner_integration:
    post:
      tags:
        - "Tenant API - Content"
      summary: Match a list of VAT numbers to recipients that have an active partner integration for a specific tenant.
      operationId: Match Companies With PAPI VatNr
      description: |
        This resource is used to match a list of Companies to check that they
        have an active integration with a partner fetching from their company inbox
        and are eligible for receiving Content from a specific Tenant.

        **Note:**
        This is only for specific use cases, and will not give you all eligible recipients.
        You most likely want to use [the regular company match](#tag/Tenant-API-Content/operation/Match%20Companies%20VatNr%20v2).

        The request contains a list of VAT numbers to be matched, and
        the response is a filtered subset of said list containing only
        those VAT numbers matching a Company Recipient for which the Tenant
        is eligible to send Content to, and have an active partner integration.

        <aside class="notice">
          If none of the provided VAT numbers match a Recipient eligible to receive content from the given Tenant, an empty list will be returned.
        </aside>
      parameters:
        - name: tenantKey
          in: path
          description: The Tenant key that the matching should be done on behalf of.
          required: true
          schema:
            type: string
            format: hexadecimal
      requestBody:
        description: |
          List of VAT numbers to be matched. The payload can be up to 10MB in size, corresponding to about 500.000 VAT numbers.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CompanyMatchSet"
            example:
              list: ["SE559408724801", "SE556917354401", "SE556840226601"]
        required: true
      security:
        - oAuth2Client:
            - "post:kivra.v2.tenant.{tenantKey}.companymatch.vatnr_with_active_partner_integration"
      responses:
        200:
          description: Filtered list of VAT numbers that matched.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CompanyMatchSet"
              example:
                list: ["SE556840226601", "SE559408724801"]
        413:
          description: Payload exceeded 10MB — try splitting into multiple calls instead.

  # ##############################################
  # GET /v1/tenant/TKEY/company
  # ##############################################
  /v1/tenant/{tenantKey}/company:
    get:
      tags:
        - "Tenant API - Content"
      summary: List available recipient companies for a tenant
      operationId: List Companies
      description: |
        This resource is used to list all, or search for specific, Companies that are eligible for receiving Content from the specific Tenant. The response is a JSON list of Objects containing the eligible Companies' VAT number.

        A search is done by providing the `vat_number` query parameter. If a search is done and the Company does not exist or have opted out of receiving Content from the Tenant an empty list will be returned.
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant.
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: vat_number
          in: query
          description: Perform a search to see if a VAT number matches an eligible Company Recipient of the Tenant.
          required: false
          schema:
            $ref: "#/components/schemas/VatNumber"
      security:
        - oAuth2Client:
            - "get:kivra.v1.tenant.{tenantKey}.company"
      responses:
        200:
          description: |
            List of Companies' keys and VAT numbers which are eligible Recipients of the Tenant.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CompanyList"

  /v2/tenant/{tenantKey}/company:
    get:
      tags:
        - "Tenant API - Content"
      summary: List available recipient companies for a tenant (v2)
      operationId: List Companies v2
      description: |
        NOTE: Access to this resource might be enabled via agreement.

        This resource is used to list all companies that are eligible
        for receiving Content from the specific Tenant.
        The `diff-id` contained in the response header can be used to fetch added/removed
        companies in subsequent requests to the "diff" endpoint described below.
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}.company"
      responses:
        200:
          description: |
            List of eligible company recipients
          headers:
            diff-id:
              description: |
                An ID that can be used in a subsequent request to
                `/v2/tenant/{tenantKey}/company/diff/{diffId}` to fetch companies
                that were added/removed since `diffId` was obtained
              schema:
                type: string
                example: "3831CD15163421134211695294"
          content:
            application/json:
              schema:
                type: array
                description: List of eligible company recipients, can be empty
                items:
                  type: object
                  properties:
                    vatnr:
                      $ref: "#/components/schemas/VatNumber"

  /v2/tenant/{tenantKey}/company/diff/{diffId}:
    get:
      tags:
        - "Tenant API - Content"
      summary: |
        List recipient companies that were added/removed since a previous request (v2)
      operationId: List Companies Diff
      description: |
        NOTE: Access to this resource might be enabled via agreement.

        This resource is used to list companies that were added/removed since
        `diffId` was obtained, either from an initial request to the
        `/v2/tenant/{tenantKey}/company` endpoint, or from a subsequent request
        to this endpoint. Note that all `diffId`s that are obtained in a
        series of requests expire 31 days after the **initial** request.
        Therefore, API users must fetch the complete company list at least once
        every 31 days.
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: diffId
          in: path
          description: |
            ID that was returned in header in a previous request and is used
            to calculate which companies have been added/removed between then
            and now
          required: true
          schema:
            type: string
            example: "3831CD15163421134211695294"
      security:
        - oAuth2Client:
            - "get:kivra.v1.tenant.{tenantKey}.user.diff.{diffId}"
      responses:
        200:
          description: |
            Lists of added/removed companies
          headers:
            diff-id:
              description: |
                An ID that can be used in a subsequent request to
                `/v2/tenant/{tenantKey}/company/diff/{diffId}` to fetch companies
                that were added/removed since `diffId` was obtained
              schema:
                type: string
                example: "3831CD15163421134211695294"
          content:
            application/json:
              schema:
                type: object
                properties:
                  added:
                    type: array
                    description: List of added users
                    items:
                      type: object
                      properties:
                        vatnr:
                          $ref: "#/components/schemas/VatNumber"
                  removed:
                    type: array
                    description: List of removed users
                    items:
                      type: object
                      properties:
                        vatnr:
                          $ref: "#/components/schemas/VatNumber"
        404:
          description: |
            The diffId does not exist (potentially because it has expired).

  # ##############################################
  # /v2/tenant/TKEY/content
  # ##############################################
  /v2/tenant/{tenantKey}/content:
    $ref: "./_partials/path-v2-tenantkey-content.yml"

  # ##############################################
  # POST, GET /v1/tenant/tenantKey/form
  # ##############################################
  /v2/tenant/{tenantKey}/form:
    post:
      tags:
        - "Tenant API - Forms"
      summary: Create form template
      operationId: createFormTemplate
      description: |
        A form template is a list of questions you would like to ask users. When sending content you can attach a form you would like a user to complete.

        Form templates are owned by the client that created them. What this means is that only the client can call the response endpoints.
        However if the client has the tenant scope it can call form template endpoints and even include a form when sending content.

        ### How to send a form to the user
        When sending a content to the user include the form template key in the context object. See `Tenant API - Content` -> `Send content (v2)` for more information.
      security:
        - oAuth2Client:
            - "post:kivra.v1.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The tenant key for the tenant who is creating the form template.
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        200:
          description: |
            Form template created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FormTemplate"
        400:
          description: |
            Can't process the request. Likely due to a client error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FormErrorResponse"
              examples:
                invalid_json:
                  value:
                    code: 40000
                    short_message: "Invalid JSON"
                    long_message: "Could not parse posted body as JSON"
        401:
          description: |
            Not authorized to make the request.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FormTemplate"
    get:
      tags:
        - "Tenant API - Forms"
      summary: Get form template keys
      operationId: getFormTemplateKey
      description: |
        Given a tenant key returns all form template keys associated with forms they created.
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique key for a tenant for whom the form templates belongs to.
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        200:
          description: |
            List of form template keys
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FormTemplateListing"
        401:
          description: |
            Not authorized to make the request

  # ##############################################
  # GET /v2/tenant/{tenantKey}/form/{formTemplateKey}
  # ##############################################
  /v2/tenant/{tenantKey}/form/{formTemplateKey}:
    get:
      tags:
        - "Tenant API - Forms"
      summary: Get form template
      operationId: getFormTemplate
      description: |
        Given a tenant key and a form template key returns the form template that the tenant created.
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique key for a tenant for whom the form template belongs to
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: formTemplateKey
          in: path
          description: The form template key associated with the form template
          required: true
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: |
            Form template
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FormTemplate"
        401:
          description: |
            Not authorized to make the request
        404:
          description: |
            Form template not found

  # ##############################################
  # GET /v2/tenant/{tenantKey}/form/{formTemplateKey}/responses
  # ##############################################
  /v2/tenant/{tenantKey}/form/{formTemplateKey}/responses:
    get:
      tags:
        - "Tenant API - Forms"
      summary: Get form response keys
      operationId: getFormResponseKeys
      description: |
        Only the client that created the form template associated with the response can call this endpoint.

        Given a tenant key and a form template key returns the form response key associated with form responses submitted by users.
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique key for a tenant for whom the form responses belong to.
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: formTemplateKey
          in: path
          description: The form template key associated with the form responses.
          required: true
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: |
            Form response ids
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FormResponseKeys"
        400:
          description: |
            Can't process the request. Likely due to a client error.
        401:
          description: |
            Not authorized to make the request
        403:
          description: |
            Forbidden from accessing the form response keys
        404:
          description: |
            The form template associated with formTemplateKey does not exist.

  # ##############################################
  # GET, DELETE /v2/tenant/{tenantKey}/form/{formTemplateKey}/responses/{responseKey}
  # ##############################################
  /v2/tenant/{tenantKey}/form/{formTemplateKey}/responses/{formResponseKey}:
    get:
      tags:
        - "Tenant API - Forms"
      summary: Get form response
      operationId: getFormResponse
      description: |
        Only the client that created the form template associated with the response can call this endpoint.

        Given a tenant key, form template key and form response key returns the form response submitted by a user.
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique key for a tenant for whom the form response belongs to.
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: formTemplateKey
          in: path
          description: The form template key associated with the form template.
          required: true
          schema:
            type: string
            format: uuid
        - name: formResponseKey
          in: path
          description: The form response key associated with the form response.
          required: true
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: |
            Form response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FormResponse"
        400:
          description: |
            Can't process the request. Likely due to a client error.
        401:
          description: |
            Not authorized to make the request
        403:
          description: |
            Forbidden from accessing the form response keys
        404:
          description: |
            Either the form template associated with the given formTemplateKey does not exist or the form response associated with the given responseKey does not exist.
    delete:
      tags:
        - "Tenant API - Forms"
      summary: Delete form response
      operationId: deleteFormResponse
      description: |
        Given a tenant key, form template key and form response key deletes the form response submitted by a user.

        Only the client that created the form template associated with the response can call this endpoint.

        ### Form responses potentially contain sensitive data. You are recommended to delete form responses from Kivra as you consume them.
      security:
        - oAuth2Client:
            - "delete:kivra.v2.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant for whom the form belongs to.
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: formTemplateKey
          in: path
          description: The form_template_key associated with the form template.
          required: true
          schema:
            type: string
            format: uuid
        - name: formResponseKey
          in: path
          description: The form response key associated with the form responses.
          required: true
          schema:
            type: string
            format: uuid
      responses:
        204:
          description: |
            Form deleted
        400:
          description: |
            Can't process the request. Likely due to a client error.
        401:
          description: |
            Not authorized to make the request
        403:
          description: |
            Forbidden from accessing the form response keys
        404:
          description: |
            Either the form template associated with the given formTemplateKey does not exist or the form response associated with the given responseKey does not exist.

  # ##############################################
  # GET /v2/tenant/{tenantKey}/registered
  # ##############################################
  /v2/tenant/{tenantKey}/registered:
    get:
      tags:
        - "Tenant API - Registered letters"
      summary: Get all responses
      operationId: getAllRegisteredLetterResponses
      description: |
        Get the responses of all registered letters that have been signed or expired.
        The response key can then be used to fetch the response details of each registered letter and also to delete the response.
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique key for a tenant for whom the registered letters belong to.
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        200:
          description: |
            List of response statuses associated with registered letters that have been either signed or expired.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/RegisteredLetterResponseStatusDetail"
        401:
          description: |
            Not authorized to make the request
        404:
          description: |
            No registered letter responses
  # ##############################################
  # GET, DELETE /v2/tenant/{tenantKey}/registered/{responseKey}
  # ##############################################
  /v2/tenant/{tenantKey}/registered/{responseKey}:
    get:
      tags:
        - "Tenant API - Registered letters"
      summary: Get response details
      operationId: getRegisteredLetterResponse
      description: |
        Get the response status of a registered letter sent by a tenant.
        A user can sign a registered letter or let it expire.

        When a user signs a registered letter, it is removed from their account, and the response is stored.
        If the letter is not signed before its expiration date, it is automatically removed as well. In both cases the response is stored.

        When sending a registered letter a `sender_reference` can be included.
        This is an optional field that can be used to store an internal reference with the registered letter.
        This field is included when fetching the response of a registered letter.
      security:
        - oAuth2Client:
            - "get:kivra.v2.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique tenant key that the registered letters belong to.
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: responseKey
          in: path
          description: The unique key of a registered letter response.
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        200:
          description: |
            The registered letter response.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegisteredLetterResponse"
        401:
          description: |
            Not authorized to make the request
    delete:
      tags:
        - "Tenant API - Registered letters"
      summary: Delete response
      operationId: deleteRegisteredLetterResponse
      description: |
        Delete a registered letter response.
        Automatically deleted after 30 days.
      security:
        - oAuth2Client:
            - "delete:kivra.v1.tenant.{tenantKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The tenant key for the tenant who sent the registered letter.
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: responseKey
          in: path
          description: The unique key of a registered letter response.
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        204:
          description: |
            Registered letter response deleted.
        400:
          description: |
            Can't process the request. Likely due to a client error.
        401:
          description: |
            Not authorized to make the request.
        403:
          description: |
            Forbidden from accessing the registered letter response.
        404:
          description: |
            The registered letter response does not exist.

  # ##############################################
  # POST /v1/tenant/{tenantKey}/ticket/event
  # ##############################################
  /v1/tenant/{tenantKey}/ticket/event:
    post:
      tags:
        - "Tenant API - Tickets (BETA)"
      summary: Create a new event
      operationId: createTenantEvent
      description: |
        Before a content of type ticket.event can be sent an event must first be created.
        This endpoint is used to create a new event. The event can then be referenced when sending content of type ticket.event.
        See the ticket metadata in v2 content API for more information on how to send content of type ticket.event.

        Note that the tenant owns the event and as such the tenant that creates the event must also send the content.
      security:
        - oAuth2Client: []
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TicketsCreateEvent"
            examples:
              Example:
                value:
                  event_reference: "event-123"
                  name: "Concert Night"
                  url: "https://example.com/event/concert-night"
                  organizer:
                    name: "Music Org"
                  information: "A night of great music."
                  images:
                    thumbnail:
                      content_type: "image/png"
                      data: "iVBORw0KGgoAAAANSUhEUgAA..."
                    landscape: null
                  schedule:
                    start: "2024-07-01T19:00:00+02:00"
                    end: "2024-07-01T23:00:00+02:00"
                    admission: "2024-07-01T18:00:00+02:00"
                  venue:
                    name: "Big Arena"
                    location:
                      city: "Stockholm"
                      address: "Arena Street 1"
                      zip: "12345"
                      coordinates:
                        longitude: "18.0686"
                        latitude: "59.3293"
      responses:
        "201":
          description: Event created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  event_key:
                    type: string
                    format: uuid
                    description: Unique identifier for the created event
                    example: "019782da-3b4a-7f6c-b8bd-e486dcf6e542"
        "400":
          description: Invalid request

  # ##############################################
  # GET,POST /v1/tenant/TKEY/agreement
  # ##############################################
  /v1/tenant/{tenantKey}/agreement:
    post:
      tags:
        - "Tenant API - Agreements"
      summary: Post an agreement to be signed
      operationId: Post Agreement
      description:
        This resource is used to post an agreement to be signed by the recipients
        listed in the metadata. An Agreement ID will be returned.

        Note that the size of the agreement file cannot exceed 1MB.
      security:
        - oAuth2Client:
            - "post:kivra.v1.tenant.{tenantKey}.agreement"
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        200:
          description: Agreement created succesfully
          content:
            application/json:
              schema:
                type: string
                example: "15544700816b7d63c83d6e476493879b5043ec9d7b"
        400:
          description: Agreement PDF was invalid
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error40045"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Agreement"
    get:
      tags:
        - "Tenant API - Agreements"
      summary: List all agreements for a tenant, with their current status
      operationId: List agreements
      description: List all agreements created by a tenant, with their current status.
      security:
        - oAuth2Client:
            - "post:kivra.v1.tenant.{tenantKey}.agreement"
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        "200":
          description: List of agreements and their status
          content:
            application/json:
              schema:
                type: array
                description: list
                items:
                  $ref: "#/components/schemas/AgreementStateShort"
                example:
                  - key: "1527232009ba54f8186d8c43e2a3c8092b57ca2739"
                    state: active
                  - key: "155265136911763308f2514ff3aa6dacc8211a2107"
                    state: revoked
                  - key: "15100645203cff9f19d92443848c8a2f1cbf257510"
                    state: completed

  # ##############################################
  # GET /v1/tenant/TKEY/agreement/AKEY
  # ##############################################
  /v1/tenant/{tenantKey}/agreement/{agreementKey}:
    get:
      tags:
        - "Tenant API - Agreements"
      summary: Agreement object with current status and updated metadata
      operationId: Get agreement
      description: Get an agreement with current status and updated metadata
      security:
        - oAuth2Client:
            - "post:kivra.v1.tenant.{tenantKey}.agreement.{agreementKey}"
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: agreementKey
          in: path
          description: The unique Key for an Agreement
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        "200":
          description: Agreement object with current status and updated metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgreementStateDetailed"

  # ##############################################
  # GET /v1/tenant/TKEY/agreement/AKEY/revoke
  # ##############################################
  /v1/tenant/{tenantKey}/agreement/{agreementKey}/revoke:
    post:
      tags:
        - "Tenant API - Agreements"
      summary: Revoke an agreement
      operationId: Revoke agreement
      description: |
        Revoke an agreement. An agreement once revoked can no longer be accessed or signed by any of the parties. An agreement can only be rekoved if in state *active*, and after revoke will be put in state *revoked*. A revoked agreement can never become active again.
      security:
        - oAuth2Client:
            - "post:kivra.v1.tenant.{tenantKey}.agreement.{agreementKey}.revoke"
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: agreementKey
          in: path
          description: The unique Key for an Agreement
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        "204":
          description: empty response confirming that the revoke operation was successful
      requestBody:
        description: empty JSON body
        content:
          application/json:
            schema: {}

  # ##############################################
  # GET /v1/tenant/TKEY/agreement/AKEY/covenant
  # ##############################################
  /v1/tenant/{tenantKey}/agreement/{agreementKey}/covenant:
    get:
      tags:
        - "Tenant API - Agreements"
      summary: Get the covenant file (signed agreement)
      operationId: Get covenant agreement
      description: |
        Get the covenant file (the signed version of the agreement).
      security:
        - oAuth2Client:
            - "post:kivra.v1.tenant.{tenantKey}.agreement.{agreementKey}.covenant"
      parameters:
        - name: tenantKey
          in: path
          description: The unique Key for a Tenant
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: agreementKey
          in: path
          description: The unique Key for an Agreement
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        "200":
          description: The covenant file as a PDF file with base64 encoding
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    description: The name of the file
                    type: string
                    example: "agreement7456_completed.pdf"
                  data:
                    description: The covenant file as a PDF file with base64 encoding
                    type: string
                    format: base64
                    example: "REVBREJFRUY="
                  sha256:
                    description: the signature to verify the file's authenticity
                    type: string

  # ##############################################
  # GET,POST /v2/tenant/TKEY/payment_cb
  # ##############################################
  /v2/tenant/{tenantKey}/payment_cb:
    get:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Lists all the tenant's defined payment webhooks.
      description: |
        This endpoint returns a list of all the payment webhooks that are
        defined for the tenant in question.
      parameters:
        - name: tenantKey
          in: path
          description: The key for the tenant.
          required: true
          schema:
            type: string
            format: hexadecimal
      responses:
        "200":
          description: "List of defined webhooks."
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PaymentCallbackDefinition"
    post:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Add a new webhook definition
      description: |
        This endpoint is used to add a new webhook definition.

        A tenant is allowed to define more than one webhook, but each one must
        have a unique URL.

        As long as a tenant has at least one webhook defined, Kivra's system
        will start accumulating data on payments made by Kivra users based on
        invoices sent by the tenant. When those payments reach certain points in
        their lifecycles, Kivra's system will make HTTPS POST requests to the
        URLs specified in the tenant's webhook definition, as long as those
        payments and events also match the rest of the fields in the defintion.
        That way a sender can choose to, for example, send events based on
        instant payments (for example Swish) to one URL and scheduled bank
        transfer payments to another URL.

        The receiving system must respond to Kivra's POST request with a
        2xx HTTP response code, and the response must come within one second of
        the connection being established.

        If the POST request is not successfully delivered, Kivra will retry up
        to ten times at increasing intervals following the recommended timetable
        from Standard Webhooks. If the delivery still has not succeeded when
        those attempts are down, the delivery attempt will be discarded.

      parameters:
        - name: tenantKey
          in: path
          description: The key for the tenant
          required: true
          schema:
            type: string
            format: hexadecimal
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  description: |
                    The URL to which Kivra will try to deliver the webhook
                    payloads. Must not be in a reserved domain, must have at
                    least one IPv4 address and must not have any IPv4 addresses
                    in a reserved range. The URL scheme must be HTTPS.
                  type: string
                  format: url
                types:
                  description: |
                    A list of the types of payments that the tenant wants to
                    receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - instant
                      - bank
                      - autogiro
                events:
                  description: |
                    A list of the payment lifecycle events that the tenant wants
                    to receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - scheduled
                      - settled
                      - failed
      responses:
        "201":
          description: |
            The definition of the just-created webhook.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentCallbackDefinition"

  # ##############################################
  # DELETE,POST /v2/tenant/TKEY/payment_cb/ID
  # ##############################################
  /v2/tenant/{tenantKey}/payment_cb/{id}:
    delete:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Remove a webhook definition.
      description: |
        This endpoint removes a webhook definition.
      parameters:
        - name: tenantKey
          in: path
          description: The key for the tenant.
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: id
          in: path
          description: The ID of the webhook definition to be changed.
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: "The webhook definition was successfully removed."
    post:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Modify a webhook definition
      description: |
        This endpoint is used to modify a webhook definition.
      parameters:
        - name: tenantKey
          in: path
          description: The key for the tenant
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: id
          in: path
          required: true
          description: |
            The ID of the webhook to be modified.
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  description: |
                    The URL to which Kivra will try to deliver the webhook
                    payloads. Must not be in a reserved domain, must have at
                    least one IPv4 address and must not have any IPv4 addresses
                    in a reserved range. The URL scheme must be HTTPS.
                  type: string
                  format: url
                types:
                  description: |
                    A list of the types of payments that the tenant wants to
                    receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - instant
                      - bank
                      - autogiro
                events:
                  description: |
                    A list of the payment lifecycle events that the tenant wants
                    to receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - scheduled
                      - settled
                      - failed
      responses:
        "200":
          description: |
            The new definition of the just-modified webhook.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentCallbackDefinition"
  # ##############################################
  # POST /v2/tenant/TKEY/payment_cb/ID/test
  # ##############################################
  /v2/tenant/{tenantKey}/payment_cb/{id}/test:
    post:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Request a test delivery for a webhook definition
      description: |
        When this endpoint is called, delivery of a webhook with static test
        data in it will be schedued. The point of this is to allow development
        of a receiving endpoint without having to go through payment flows to
        trigger test data. Note that the content of the test webhook is
        nonsense, only the shape of the data and its signature are real.
      parameters:
        - name: tenantKey
          in: path
          description: The key for the tenant
          required: true
          schema:
            type: string
            format: hexadecimal
        - name: id
          in: path
          required: true
          description: |
            The ID of the webhook to be modified.
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json: {}
      responses:
        "204":
          description: |
            A test delivery was successfully scheduled.

  # ##############################################
  # GET,POST /v2/webhooks/payments
  # ##############################################
  /v2/webhooks/payments:
    get:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Lists all the partner's defined payment webhooks.
      description: |
        This endpoint returns a list of all the payment webhooks that are
        defined for the partner in question.
      responses:
        "200":
          description: "List of defined webhooks."
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PaymentWebhookDefinition"
    post:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Add a new webhook definition
      description: |
        This endpoint is used to add a new webhook definition.

        A partner is allowed to define more than one webhook. It's up
        to the partner themselves to make sure not to create duplicate
        definitions. If they do, they will receive duplicate webhooks
        for the same payments.

        A webhook definition essentially consists of a destination
        URL, and four fields defining a filter for which payments
        should be reported on. The fields are:

          - cid_filter: The client id of the partner who sent the
            invoice the payment was based on to Kivra. Can be a key or
            the special value `*`, which means all keys. This value is
            not possible to set via this API, since it would allow
            leaking information between partners. If you need to
            receive webhooks for payments based on invoices sent by
            another partner, contact Kivra.

          - tkey_filter: The tenant key for the actual sender of the
            invoice the payment was based on. This may be the same
            entity as the sending client, but very often is not. This
            key may also be set to the special value `*`, in which
            case webhooks will be delivered for all invoiced sent by
            the given client id, no matter which tenant they were sent
            on behalf of. It is never allowed for both this key and
            `cid_filter` to be set to `*`, since that would mean
            reporting on absolutely every payment made through Kivra.

          - payment_type: A list consisting with strings representing
            the types of payments webhooks should be delivered for.
            Currently available are `instant` (Swish), `bank` and
            `autogiro`.

          - payment_event: A list of the events concerning a payment
            that a webhook should be delivered for. Currently
            available are `scheduled`, `settled` and `failed`.

        The receiving system must respond to Kivra's POST request with a
        2xx HTTP response code, and the response must come within one second of
        the connection being established.

        If the POST request is not successfully delivered, Kivra will retry up
        to ten times at increasing intervals following the recommended timetable
        from Standard Webhooks. If the delivery still has not succeeded when
        those attempts are down, the delivery attempt will be discarded.

      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  description: |
                    The URL to which Kivra will try to deliver the webhook
                    payloads. Must not be in a reserved domain, must have at
                    least one IPv4 address and must not have any IPv4 addresses
                    in a reserved range. The URL scheme must be HTTPS.
                  type: string
                  format: url
                cid_filter:
                  description:
                    The client key of the party that made the API call
                    to send the invoice the payment was based on to
                    Kivra.
                  type: string
                tkey_filter:
                  description:
                    The tenant key of the sender of the invoice the
                    payment was based on.
                  type: string
                types:
                  description: |
                    A list of the types of payments that the tenant wants to
                    receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - instant
                      - bank
                      - autogiro
                events:
                  description: |
                    A list of the payment lifecycle events that the tenant wants
                    to receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - scheduled
                      - settled
                      - failed
      responses:
        "201":
          description: |
            The definition of the just-created webhook.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentWebhookDefinition"

  # ##############################################
  # DELETE,PATCH /v2/webhooks/payments/ID
  # ##############################################
  /v2/webhooks/payments/{id}:
    delete:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Remove a webhook definition.
      description: |
        This endpoint removes a webhook definition.
      parameters:
        - name: id
          in: path
          description: The ID of the webhook definition to be changed.
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: "The webhook definition was successfully removed."
    patch:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Modify a webhook definition
      description: |
        This endpoint is used to modify a webhook definition.
      parameters:
        - name: id
          in: path
          required: true
          description: |
            The ID of the webhook to be modified.
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  description: |
                    The URL to which Kivra will try to deliver the webhook
                    payloads. Must not be in a reserved domain, must have at
                    least one IPv4 address and must not have any IPv4 addresses
                    in a reserved range. The URL scheme must be HTTPS.
                  type: string
                  format: url
                cid_filter:
                  description:
                    The client key of the party that made the API call
                    to send the invoice the payment was based on to
                    Kivra.
                  type: string
                tkey_filter:
                  description:
                    The tenant key of the sender of the invoice the
                    payment was based on.
                  type: string
                types:
                  description: |
                    A list of the types of payments that the tenant wants to
                    receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - instant
                      - bank
                      - autogiro
                events:
                  description: |
                    A list of the payment lifecycle events that the tenant wants
                    to receive webhooks for.
                  type: array
                  items:
                    type: string
                    enum:
                      - scheduled
                      - settled
                      - failed
      responses:
        "200":
          description: |
            The new definition of the just-modified webhook.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentWebhookDefinition"
  # ##############################################
  # POST /v2/webhooks/payments/ID/test
  # ##############################################
  /v2/webhooks/payments/{id}/test:
    post:
      tags:
        - "Tenant API - Payment Webhooks"
      summary: Request a test delivery for a webhook definition
      description: |
        When this endpoint is called, delivery of a webhook with static test
        data in it will be schedued. The point of this is to allow development
        of a receiving endpoint without having to go through payment flows to
        trigger test data. Note that the content of the test webhook is
        nonsense, only the shape of the data and its signature are real.
      parameters:
        - name: id
          in: path
          required: true
          description: |
            The ID of the webhook to be modified.
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json: {}
      responses:
        "204":
          description: |
            A test delivery was successfully scheduled.

  # ##############################################
  # GET /v1/partner/company
  # ##############################################
  /v1/partner/company:
    get:
      tags:
        - "Partner API v1"
      summary: Lookup a specific company
      operationId: Find Company
      description: |
        This resource allows a partner to look if a specific company has granted access to its mailbox.
        <aside class="notice">
        If a search is done and the Company doesn’t exist in Kivra or has not granted access to the partner, an empty list will be returned.
        </aside>
      parameters:
        - name: vat_number
          in: query
          description: Perform a search to see if a specific Company is available for access
          required: true
          schema:
            description: Company's unique VAT number
            type: string
            example: SE556840226601
      security:
        - oAuth2Client:
            - "get:kivra.v1.partner.company"
      responses:
        200:
          description: Company key for the company with the matching VAT number
          content:
            application/json:
              schema:
                type: object
                properties:
                  key:
                    description: Company's unique Key
                    type: string
                    example: "15236156848eefa1dc75364af2be38c98eb3aae223"

  # ##############################################
  # GET /v1/partner/company/COMPKEY/content
  # ##############################################
  /v1/partner/company/{companyKey}/content:
    get:
      tags:
        - "Partner API v1"
      summary: Get the company inbox
      operationId: Get company inbox
      description: This resource allows to access a high level description for each content in the company inbox, to allow for a first sorting and filtering of the content.
      parameters:
        - name: companyKey
          in: path
          description: The unique key for the company object being retrieved
          required: true
          schema:
            description: Company's unique key
            type: string
      security:
        - oAuth2Client:
            - "get:kivra.v1.partner.company.{companyKey}"
      responses:
        200:
          description: High level description of content items in the company inbox
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CompanyInbox"

  # ##############################################
  # GET /v1/partner/company/COMPKEY/content/CONTKEY
  # ##############################################
  /v1/partner/company/{companyKey}/content/{contentKey}:
    get:
      tags:
        - "Partner API v1"
      summary: Get metadata for a content.
      operationId: Get content metadata
      description:
        This resource allows to get complete metadata information for a particular content.
        <aside class="notice">
        Depending on the `content_type` for each parts of the content, Kivra will return either a `key` to a binary file to be retrieved or (for text based contents) the `body` of the content itself.
        </aside>
      parameters:
        - name: companyKey
          in: path
          description: The unique key for the company object being retrieved
          required: true
          schema:
            description: Company's unique key
            type: string
        - name: contentKey
          in: path
          description: The unique key for a specific content
          required: true
          schema:
            description: Content's unique key
            type: string
      security:
        - oAuth2Client:
            - "get:kivra.v1.partner.company.{companyKey}.**"
      responses:
        200:
          description: Complete metadata for the specific content
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CompanyContent"

  # ##############################################
  # GET /v1/partner/company/COMPKEY/content/CONTKEY/file/FKEY/raw
  # ##############################################
  /v1/partner/company/{companyKey}/content/{contentKey}/file/{fileKey}/raw:
    get:
      tags:
        - "Partner API v1"
      summary: Get raw file in binary format
      operationId: Get raw file
      description: This resource allows to get the raw file in binary format.
      parameters:
        - name: companyKey
          in: path
          description: The unique key for the company object being retrieved
          required: true
          schema:
            description: Company's unique key
            type: string
        - name: contentKey
          in: path
          description: The unique key for a specific content
          required: true
          schema:
            description: Content's unique key
            type: string
        - name: fileKey
          in: path
          description: The unique key for a specific file
          required: true
          schema:
            description: File's unique key
            type: string
      security:
        - oAuth2Client:
            - "get:kivra.v1.partner.company.{companyKey}.**"
      responses:
        200:
          description: The content type will be the same as the file, so for a typical pdf it will be `application/pdf`
          content:
            application/json:
              schema:
                type: string
                format: binary

  # ##############################################
  # POST /v1/partner/company/COMPKEY/content/CONTKEY/STATUS
  # ##############################################
  /v1/partner/company/{companyKey}/content/{contentKey}/{status}:
    post:
      tags:
        - "Partner API v1"
      summary: Set status for content
      operationId: Set status for content
      description: This resource allows to set the status for a specific content. It is used by the partner to set whether the content should be marked as viewed or paid.
      parameters:
        - name: companyKey
          in: path
          description: The unique key for the company object being retrieved
          required: true
          schema:
            description: Company's unique key
            type: string
        - name: contentKey
          in: path
          description: The unique key for a specific content
          required: true
          schema:
            description: Content's unique key
            type: string
        - name: status
          in: path
          description: The specific state to be set for this content, can be `paid`, `unpaid`, `view` or `unview`
          required: true
          schema:
            description: The new state to be set for the content
            type: string
      security:
        - oAuth2Client:
            - "get:kivra.v1.partner.company.{companyKey}.**"
      responses:
        204:
          description: empty response confirming that the operation was successful
      requestBody:
        description: empty JSON body
        content:
          application/json:
            schema: {}

  # ##############################################
  # GET /v3/partner/company
  # ##############################################
  /v3/partner/company:
    get:
      tags:
        - "Partner API v3"
      summary: List accessible companies
      operationId: List companies
      description: List the companies the client has access to
      parameters:
        - name: field
          in: query
          schema:
            type: array
            items:
              $ref: "#/components/schemas/FieldQueryParameter"
        - name: vat_number
          in: query
          schema:
            type: array
            items:
              $ref: "#/components/schemas/VatNumber"
      responses:
        "200":
          description: >
            If `vat_number` is given, the repsonse will only include companies with VAT numbers in that list.
            The `field` parameter controls which columns (CSV) or properties (JSON) to include in the response.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BaseCompany"
            text/csv:
              schema:
                type: string
              example: |
                key,type,name,vat_number
                2156077433683911cdca5fd4563bded979572454cb9,company,Cornelias
                Café AB,SE556000475501

  # ##############################################
  # GET /v3/partner/company/COMPKEY
  # ##############################################
  /v3/partner/company/{companyKey}:
    get:
      tags:
        - "Partner API v3"
      summary: Company information
      operationId: Get company information
      description: |
        Get detailed information for a single company.
      parameters:
        - name: companyKey
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/CompanyKey"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FullCompany"

  # ##############################################
  # GET /v3/partner/company/COMPKEY/content
  # ##############################################
  /v3/partner/company/{companyKey}/content:
    get:
      tags:
        - "Partner API v3"
      summary: List company inbox
      operationId: List content in the company inbox
      description: |
        List the content the company has received.
        This may be filtered by certain `labels` and specific fields may be selected using `field`.

        Note that more content metadata is available via the
        [Get specific content](#tag/Partner-API-v3/operation/Get%20content) endpoint.
      parameters:
        - name: companyKey
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/CompanyKey"
        - name: handled
          in: query
          schema:
            $ref: "#/components/schemas/HandledLabel"
        - name: viewed
          in: query
          schema:
            $ref: "#/components/schemas/ViewedLabel"
        - name: field
          in: query
          schema:
            type: array
            items:
              $ref: "#/components/schemas/FieldQueryParameter"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/BaseContentMetadata"

  # ##############################################
  # GET,PATCH /v3/partner/company/COMPKEY/content/CONTKEY
  # ##############################################
  /v3/partner/company/{companyKey}/content/{contentKey}:
    get:
      tags:
        - "Partner API v3"
      summary: Get specific content
      description: |
        ### Content metadata

        Get metadata about a specific content in JSON format.

        ### Content file data

        A given content can contain multiple files ("parts"). Fetching of such parts is done by passing the `part` query parameter.

        A part can also be selected by setting the `Accept` header to the MIME type of the part you want
        (see `parts` in the metadata JSON response). You will receive the first part that matches the given
        MIME type.
      operationId: Get a specific company content
      parameters:
        - name: companyKey
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/CompanyKey"
        - name: contentKey
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/ContentKey"
        - name: part
          in: query
          schema:
            $ref: "#/components/schemas/PartQueryParameter"
      responses:
        "200":
          description: Content metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FullContentMetadata"
            "*/*":
              schema:
                $ref: "#/components/schemas/ContentPart"
    patch:
      tags:
        - "Partner API v3"
      summary: Update content metadata
      operationId: Update company content metadata
      parameters:
        - name: companyKey
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/CompanyKey"
        - name: contentKey
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/ContentKey"
      responses:
        "200":
          description: Content metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FullContentMetadata"
            "*/*":
              schema:
                $ref: "#/components/schemas/ContentPart"
      requestBody:
        content:
          application/json:
            schema:
              additionalProperties: false
              properties:
                labels:
                  additionalProperties: false
                  properties:
                    handled:
                      description: Mark the content as `handled`/`unhandled`
                      $ref: "#/components/schemas/HandledLabel"
                    viewed:
                      description: Mark the content as `viewed`/`unviewed`
                      $ref: "#/components/schemas/ViewedLabel"
                  type: object
              type: object
        required: true

components:
  schemas:
    # ##############################################
    # SCHEMA TicketsCreateEvent
    # ##############################################
    TicketsCreateEvent:
      type: object
      required: ["event_reference", "name", "organizer", "schedule", "venue"]
      properties:
        event_reference:
          type: string
          description: Used for uniqness of the event, only one event can be created with a specific event_reference.
        name:
          type: string
          description: The name of the event.
        url:
          type: [string, "null"]
          format: uri
          description: A URL to the event's website or more information. Must be HTTPS.
        organizer:
          type: object
          required: [name]
          properties:
            name:
              type: string
        information:
          type: [string, "null"]
        images:
          type: [object, "null"]
          properties:
            thumbnail:
              type: [object, "null"]
              required: [content_type, data]
              properties:
                content_type:
                  type: string
                  enum: ["image/jpeg", "image/png", "image/webp"]
                data:
                  type: string
                  description: Base64 encoded string
            landscape:
              type: [object, "null"]
              required: [content_type, data]
              properties:
                content_type:
                  type: string
                  enum: ["image/jpeg", "image/png", "image/webp"]
                data:
                  type: string
                  description: Base64 encoded string
        schedule:
          type: object
          required: [start]
          properties:
            start:
              type: string
            end:
              type: [string, "null"]
            admission:
              type: [string, "null"]
        venue:
          type: object
          required: [name]
          properties:
            name:
              type: string
            location:
              type: [object, "null"]
              properties:
                city:
                  type: [string, "null"]
                address:
                  type: [string, "null"]
                zip:
                  type: [string, "null"]
                coordinates:
                  type: [object, "null"]
                  required: [longitude, latitude]
                  properties:
                    longitude:
                      type: string
                    latitude:
                      type: string
    # ##############################################
    # SCHEMA TicketEventMetadata
    # ##############################################
    TicketEventMetadata:
      type: object
      required: [event_key, tickets]
      properties:
        event_key:
          type: string
          description: Reference to the event (created via /tickets/event)
        order_id:
          type: [string, "null"]
          description: Optional order identifier
        group_ticket:
          type: [object, "null"]
          properties:
            qr_data:
              type: string
              description: QR code data for the group ticket
          required: [qr_data]
        tickets:
          type: array
          minItems: 1
          items:
            type: object
            required: [qr_data, type]
            properties:
              seating:
                type: [object, "null"]
                properties:
                  seat:
                    type: [string, "null"]
                  row:
                    type: [string, "null"]
                  section:
                    type: [string, "null"]
                  gate:
                    type: [string, "null"]
              qr_data:
                type: string
                description: QR code data for the ticket
              type:
                type: string
                description: Ticket type (e.g., "Standard", "VIP")

    # ##############################################
    # SCHEMA Content_user
    # ##############################################
    Content_user:
      $ref: "./_partials/schema-v2-tenantkey-content-response.yml"

    # ##############################################
    # ⚡⚡⚡ SCHEMA SalarySlip - NEW! ⚡⚡⚡
    # ##############################################
    SalarySlip:
      description: |
        ⚡⚡⚡ NEW SALARY SLIP SCHEMA ⚡⚡⚡

        Comprehensive salary slip metadata schema for the "salaryslip" content type.
        Contains structured information about employee salary, benefits, taxes, and employment details.
      $ref: "./_partials/schema-salary-slip.yml"

    # ##############################################
    # SCHEMA Content_user_v2
    # ##############################################
    Content_user_v2:
      type: object
      required:
        - subject
        - type
      properties:
        ssn:
          description: |
            User's unique SSN, according to the `YYYYMMDDnnnn` format
          type: string
          writeOnly: true
          example: "191212121212"
        email:
          description: |
            A kivra user's verified email address.
          type: string
          writeOnly: true
          example: "Kivra.Sweden@example.com"
        subject:
          description: |
            The subject/title will be visibile in the Recipients Inbox.
            Keep the subject short and concise (i.e. up to 30-35 characters) to make sure that is fully visible on most screen sizes.
            Avoid using personal or sensitive information in the subject.
          type: string
          example: "Invoice for March 2022"
        generated_at:
          type: string
          format: ISO8601
          example: "2022-12-31"
          description: |
            Optional attribute which denotes when a specific Content was generated at the tenant/integrator’s site.
            The attribute will be used for sorting in the Kivra user interface, which makes it possible for a tenant or integrator to control the sorting.
        type:
          type: string
          example: "letter"
          description: |
            Optional attribute providing information about the type of content being sent.
            The type of a content may influence how the user interacts with the content and how the user is notified about the content.
            Allowed values are:
            - `"letter"`: indicating that the content is an information letter. This is the default type for all non-payable content.
            - `"letter.salary"`: indicating that the content is a salary specification. This type support the retained functionality.
            - `"salaryslip"`: ⚡⚡⚡ NEW SALARY SLIP TYPE ⚡⚡⚡ indicating that the content is a salary slip with structured metadata. A valid `salary_slip` object needs to be provided. This type includes detailed payment information, employer details, benefits, holidays, and tax information.
            - `"letter.creditnotice"`: indicating that the content is a creditnotice. This type support the retained functionality.
            - `"letter.form"`: indicating that the content contains a form.
            - `"letter.signed"`: indicates that the content contains a signed document. This type support the retained functionality.
            - `"invite.research"`: for invitations to participate in surveys and polls.
            - `"invite.gift"`: for invitations to collect a gift.
            - `"invite.sign"`: for invitations to sign a document. This type support the retained functionality.
            - `"invite.voucher"`: for invitations to use a voucher
            - `"invite.kyc"`: for invitations to complete KYC (Know Your Customer) process.
            - `"invoice"`: |
              indicating that the content is an invoice. A valid `payment_multiple_options` object needs to be provided and the `payable` attribute must be set to `true`.
              This is the default type for all payable content.
            - `"invoice.reminder"`: |
              indicating that the content is an invoice, a reminder for a previously unpaid invoice.
              The invoice might include late fees and other differences compared to the original invoice.
              A valid `payment_multiple_options` object needs to be provided and the `payable` attribute must be set to `true`.
            - `"invoice.debtcampaign"`: |
              indicating that the content is an invoice or payment plan from a debt collection company.
              The invoice might include fees such as interest and reminder fees. A valid `payment_multiple_options` object needs to be provided and the `payable` attribute must be set to `true`.
              This content types enables long due dates with a longer notification scheme
            - `"invoice.renewal"`: |
              indicating that the content is not a real invoice, but an offer that is voluntary to pay for the receiver.
              It can be used to send an offer to renew a subscription, insurance or similar.
              A valid `payment_multiple_options` object needs to be provided and the `payable` attribute must be set to `true`.
            - `"invoice.debtcollection"`: |
              indicating that the content is a debt collection claim (in Swedish: "inkassokrav").
              A valid `payment_multiple_options` object needs to be provided and the `payable` attribute must be set to `true`.
            - `"booking"`: indicating that the content is a booking/appointement.
            - `"registered.letter"`: Indicating that the content is a registered letter. A valid `registered` object needs to be provided. Note that email matching is not yet supported for this content type.
            - `"invoice.donation"`: indicating that the content is a donation where the payment by the user is optional.
              A valid `payment_multiple_options` object needs to be provided and the `payable` attribute must be set to `true`.
            - `"invoice.paymentnotice"`: indicating that the content is a payment notice targeting the needs of membership organizations.
              A valid `payment_multiple_options` object needs to be provided and the `payable` attribute must be set to `true`.
            - `"ticket.event"` (BETA): indicating that the content is a ticket for an event. A valid `ticket` object needs to be provided. **Note that this feature is not yet available. It will become available in June 2026**
        retain:
          description: |
            Boolean denoting if Kivra should try and retain this Content if it can’t be delivered. Default `false`.
            Please note that retain can only be used with content types `letter.creditnotice`, `letter.salary`, `letter.signed`
            and `invite.sign`, otherwise an error with status code `422` will be returned.
          type: boolean
          writeOnly: true
          example: false
        retention_time:
          description: |
            How long to retain a Content. Supported values: `"30"` and `"390"`
          type: string
          writeOnly: true
          example: "30"
          enum: ["30", "390"]
        parts:
          description: Array of file Objects
          type: array
          writeOnly: true
          items:
            $ref: "#/components/schemas/Parts_Responsive"
        payment_multiple_options:
          type: object
          description: |
            Specify payment information for both single and multiple payment options
          $ref: "#/components/schemas/PaymentMultipleOptions"
        booking:
          description: Optionally specify booking information
          $ref: "#/components/schemas/Booking"
        campaign:
          description: Optionally attach a campaign
          $ref: "#/components/schemas/Campaign"
        form:
          description: Optionally attach a form
          $ref: "#/components/schemas/Form"
        invite_research:
          description: Optional invite research
          $ref: "#/components/schemas/InviteResearch"
        invite_gift:
          description: Optional invite gift
          $ref: "#/components/schemas/InviteGift"
        invite_sign:
          description: Optional invite sign
          $ref: "#/components/schemas/InviteSign"
        invite_voucher:
          description: Optional invite voucher
          $ref: "#/components/schemas/InviteVoucher"
        signed:
          description: Optional signed metadata
          $ref: "#/components/schemas/Signed"
        invite_kyc:
          description: Optional invite kyc
          $ref: "#/components/schemas/InviteKyc"
        salary_slip:
          description: |
            ⚡⚡⚡ NEW SALARY SLIP OBJECT ⚡⚡⚡

            Optional salary slip with structured metadata for "salaryslip" content type.

            This object contains comprehensive salary information including:
            - Document metadata (creation timestamp, source system)
            - Employment details (start date, type, weekly hours)
            - Pay period information (dates, hours worked, salary breakdown)
            - Employer information (legal name, contact details)
            - Employee benefits (healthcare, pension, meals)
            - Holiday/vacation information
            - Tax information and deductions

            All monetary amounts must use period (.) as decimal separator with up to 2 decimal places.
            All dates must be in ISO 8601 format.
          $ref: "#/components/schemas/SalarySlip"
        registered:
          description: Optional registered letter
          $ref: "#/components/schemas/RegisteredLetter"
        ticket:
          description: Optional ticket metadata
          $ref: "#/components/schemas/TicketEventMetadata"

    # ##############################################
    # SCHEMA Form Template
    # ##############################################
    FormTemplate:
      type: object
      required:
        - title
        - description
        - questions
        - key
        - created_at
        - start_question
        - version
      properties:
        title:
          type: string
          description: |
            The title of the form.
          example: Customer KYC
        description:
          type: string
          description: |
            The purpose of the form.
          example: Your bank has some questions
        start_question:
          type: string
          description: |
            The id of the first question in questions that will be asked to the user.
          example: number_deposits
        questions:
          type: array
          description: |
            The questions that you want to ask the user.
          items:
            $ref: "#/components/schemas/FormQuestion"
          example:
            - label: How many times per month do you deposit into your account?
              id: number_deposits
              type: number
              next_question: largest_sum
            - label: What is the largest amount deposited?
              id: largest_sum
              type: options
              options:
                - id: small
                  label: 10000 - 20000
                - id: medium
                  label: 20000 - 30000
                - id: large
                  label: 30000 - 40000
                  next_question: source
              next_question: citizenship
            - label: Select your country of citizenship
              id: citizenship
              type: multi_options
              options:
                - id: swe
                  label: Sweden
                - id: no
                  label: Norway
                - id: dk
                  label: Denmark
              min: 1
              max: 2
              next_question: comments
            - label: What is the source of the deposit?
              id: source
              type: free_text
              next_question: account
            - label: Select your salary account
              id: account
              type: verified_account
              next_question: comments
            - label: Do you have any further comments?
              id: comments
              type: free_text
              help_text: This can be any type of feedback that you have.
        key:
          type: string
          format: uuid
          description: |
            The key of the newly created form template.
          readOnly: true
          example: "2877d684-a340-4e4c-867f-d93283787b01"
        created_at:
          type: string
          description: |
            The date the form template was created.
          readOnly: true
          example: "2022-11-23T14:51:23.874434Z"
        version:
          type: integer
          description: |
            The form template version
          readOnly: true
          example: 1
    FormQuestion:
      type: object
      required:
        - type
        - label
        - id
      properties:
        type:
          type: string
          enum: [free_text, number, options, multi_options, verified_account]
          description: |
            The input type required to answer the question.

            `free_text` is a string.

            `number` is an integer.

            `options` is a list of `FormOption` objects.

            `multi_options` is a list of `FormMultiOption` objects.

            `verified_account` is a string containing the IBAN of the account.
        label:
          type: string
          description: |
            Human readable description of what the question is.
        id:
          type: string
          description: |
            A key used to identify the question.
        help_text:
          type: string
          description: |
            Provides the user with more information about the question.
        next_question:
          type: string
          description: |
            The question id of the next question that the user will be asked.

            If question is of type `options` then this value is overridden if `next_question` is present on the option that the user selects.

            If `next_question` is not present on the question or option then this will be the last question that the user is asked.
        options:
          type: array
          description: |
            When `type` is `options` then use this to specify the answers that the user can select.
          items:
            $ref: "#/components/schemas/FormOption"
        multi_options:
          type: array
          description: |
            When `type` is `multi_options` then use this to specify the answers that the user can select.
          items:
            $ref: "#/components/schemas/FormMultiOption"
        min:
          type: integer
          description: |
            When `type` is `number` then use this to specify the minimum (inclusive) value to accept in the response.
            When `type` is `multi_option` then use this to specify the minimum number of options that the user can select.
        max:
          type: integer
          description: |
            When `type` is `number` then use this to specify the maximum (inclusive) value to accept in the response.
            When `type` is `multi_option` then use this to specify the maximum number of options that the user can select.
    FormOption:
      type: object
      required:
        - id
        - label
      properties:
        id:
          type: string
          description: |
            A key used to identify the answer.
        label:
          type: string
          description: |
            A human readable description of the answer.
        next_question:
          type: string
          description: |
            The question id of the next question that the user will be asked.

            This value overrides any potential `next_question` value on the question level.

            If `next_question` is not present on the question or option then this will be the last question that the user is asked.
    FormMultiOption:
      type: object
      required:
        - id
        - label
      properties:
        id:
          type: string
          description: |
            A key used to identify the answer.
        label:
          type: string
          description: |
            A human readable description of the answer.
    FormTemplateKey:
      type: object
      required:
        - form_template_key
        - response_count
      properties:
        key:
          type: string
          description: |
            A key used to identify the form template.
          example: 2877d684-a340-4e4c-867f-d93283787b01
        response_count:
          type: integer
          minimum: 0
          description: |
            Count of responses available to collect from this template key

    FormTemplateListing:
      type: object
      required:
        - forms
      properties:
        forms:
          type: array
          description: |
            form template details
          items:
            $ref: "#/components/schemas/FormTemplateKey"
    RegisteredLetterResponseStatus:
      type: enum
      description: Status of the registered letter response.
      enum: [signed, expired]
    RegisteredLetterResponseStatusDetail:
      type: object
      properties:
        key:
          type: string
          description: Response key
        status:
          $ref: "#/components/schemas/RegisteredLetterResponseStatus"
    RegisteredLetterResponse:
      type: object
      properties:
        status:
          $ref: "#/components/schemas/RegisteredLetterResponseStatus"
        signed_at:
          type: string
          nullable: true
          format: ISO8601
          description: When the registered letter was signed
          example: "2025-06-15T12:00:10Z"
        sender_reference:
          type: object
          nullable: true
          description: The same object that was passed by the sender when creating the registered letter. Null if nothing was passed.
          example:
            internal_id: "6eb7d1b9-ccd6-408f-ade7-9a1837be3ecf"
        content_key:
          type: string
          example: "2877d684-a340-4e4c-867f-d93283787b01"
        bank_id_order:
          type: object
          nullable: true
          description: Returns the same as the BankID collect endpoint, however *bankIdIssueDate*, *uhi* and *risk* are excluded.
          externalDocs:
            description: "More details about this object can be found here."
            url: "https://developers.bankid.com/api-references/auth--sign/collect"
          example:
            orderRef: "0197b142-2c15-74a7-9850-3b68087ad4ec"
            status: "completed"
            completionData:
              user:
                personalNumber: "197701032380"
                name: "Jan-Erik Karlsson"
                givenName: "Jan-Erik"
                surname: "Karlsson"
              device:
                ipAddress: "142.250.74.206"
              stepUp:
                mrtd: false
              signature: "PD94bWwgdmVyc2lvb..."
              ocspResponse: "MIIHdgoBAKCCB28wggdrBg..."

    # ##############################################
    # SCHEMA Form Response
    # ##############################################
    FormResponseKeys:
      type: object
      required:
        - form_template_key
        - responses
      properties:
        form_template_key:
          type: string
          format: uuid
          description: |
            The form template key associated with the form responses.
          example: 2877d684-a340-4e4c-867f-d93283787b01
        responses:
          type: array
          description: |
            Metadata about the form response
          items:
            type: object
            properties:
              form_response_key:
                type: string
                format: uuid
                description: |
                  A key used to identify the individual form response.
                example: bed773d7902942f29f0b0729390c962c
    FormResponse:
      type: object
      required:
        - form_response_key
        - form_template_key
        - responses
        - matched_by
        - login_method
        - responded_at
        - sender_reference
      properties:
        form_response_key:
          type: string
          format: uuid
          description: The form response key
          example: 2877d684-a340-4e4c-867f-d93283787b01
        form_template_key:
          type: string
          format: uuid
          description: The form template key.
          example: 2877d684-a340-4e4c-867f-d93283787b01
        response:
          type: array
          description: The form response that the user submitted.
          items:
            type: object
            properties:
              id:
                type: string
                description: |
                  A key used to identify the question.
              value:
                type: object
                additionalProperties:
                  oneOf:
                    - type: string
                    - type: number
                    - $ref: "#/components/schemas/VerifiedAccount"
                description: |
                  The response to the question.
              type:
                type: string
                enum: [free_text, number, options, multi_options]
                description: |
                  The input type required to answer the question.

                  `free_text` is a string.

                  `number` is an integer.

                  `options` can be a string or an integer.

                  `multi_options` is a list of `options`.

                  `verified_account` an object containing account information.
            example:
              - id: number_deposits
                value: 1
                type: number
              - id: largest_sum
                value: small
                type: options
              - id: comments
                value: No further comments
                type: free_text
              - id: account
                type: verified_account
                value:
                  account_number: "1234-5678"
                  bank_name: "Bank"
                  clearing_number: "1234"
              - id: citizenship
                type: multi_options
                value: ["Swedish", "German"]
        matched_by:
          type: object
          description: Used to identify the user that answered the form
          required:
            - type
            - value
          properties:
            type:
              type: string
              enum: [ssn, email]
              description: How the user that answered the form was identified.
              example: ssn
            value:
              type: string
              description: Represents a value used to identify a user e.g. ssn or email.
              example: 199202286837
        login_method:
          type: string
          enum: [bankid]
          description: How the user that submitted the form logged into Kivra
          example: bankid
        responded_at:
          type: string
          format: ISO8601
          description: When Kivra received a response to the form
          example: 2023-08-22T12:39:29.000000Z
        sender_reference:
          type: object
          nullable: true
          description: Provided reference data in content sendout is included in the form response.
          example:
            internal_id: "6eb7d1b9-ccd6-408f-ade7-9a1837be3ecf"
    BasicErrorResponse:
      type: object
      required:
        - code
        - short_message
        - long_message
      properties:
        code:
          type: integer
          description: An error code identifying the reason of the unsuccessful request.
        short_message:
          type: string
          description: Short human-readable description.
        long_message:
          type: string
          description: Longer human-readable description getting into details.
    FormErrorResponse:
      allOf:
        - $ref: "#/components/schemas/BasicErrorResponse"
        - type: object

    # ##############################################
    # SCHEMA Verified Account
    # ##############################################
    VerifiedAccount:
      type: object
      description: Account information for verified account
      required:
        - account_number
        - bank_name
      properties:
        account_number:
          type: string
          description: User's account number.
        bank_name:
          type: string
          description: Name of the bank the account belongs to.
        clearing_number:
          type: string
          description: The number used for the identification of financial institutions.

    # ##############################################
    # SCHEMA Content_company
    # ##############################################
    Content_company:
      type: object
      required:
        - vat_number
      properties:
        vat_number:
          description: |
            A valid VAT-identifier, Swedish format: `SE[xxxxxxxxxx]01`
          type: string
          writeOnly: true
          example: SE556840226601
        subject:
          description: This Subject/Title will be visibile in the Recipients Inbox.
          type: string
          example: "Sample Invoice"
        generated_at:
          type: string
          format: ISO8601
          example: "2016-12-12"
          description: |
            Optional attribute which denotes when a specific Content was generated at the tenant/integrator’s site. The attribute will be used for sorting in the Kivra user interface, which makes it possible for a tenant or integrator to control the sorting.
        type:
          type: string
          example: "letter"
          description: |
            Optional attribute providing information about the type of content being sent. The type of a content may influence how the user interacts with the content and how the user is notified about the content.
              Allowed values are:
              - `"accounting.invoice"` (BETA): indicating that the content is a structured invoice that can be shared to the accounting system used by the receiver. A valid `invoice` object needs to be provided.
              - `"accounting.invoicereminder"` (BETA): indicating that the content is a structured invoice (reminder) that can be shared to the accounting system used by the receiver. A valid `invoice` object needs to be provided.
              - `"accounting.invoicecreditnote"` (BETA): indicating that the content is a structured invoice (credit invoice) that can be shared to the accounting system used by the receiver. A valid `invoice` object needs to be provided.
              - `"letter"`: indicating that the content is an information letter. This is the default type for all non-payable content.
              - `"invoice"`: indicating that the content contains payment information. This value can only be used when a "payment" object is provided and the "payable" attribute is set to true. This is the default type for all payable content.
              - `"letter.salary"`: indicating that the content is a salary specification.
              - `"letter.creditnotice"`: indicating that the content is a creditnotice.
              - `"invite.research"`: indicating that the content is an invitation to participate in a survey or poll.
              - `"invite.kyc"`: indicating that the content is an invitation to complete a KYC (Know Your Customer) process.

        parts:
          description: files composing the content
          type: array
          items:
            $ref: "#/components/schemas/Parts"
        payment_multiple_options:
          type: object
          description: |
            Specify payment information for both single and multiple payment options
          $ref: "#/components/schemas/PaymentMultipleOptions"
        invoice:
          description: Optional invoice (BETA)
          $ref: "#/components/schemas/Invoice"
        invite_research:
          description: Optional invite research
          $ref: "#/components/schemas/InviteResearch"
        invite_kyc:
          description: Optional invite kyc
          $ref: "#/components/schemas/InviteKyc"

    # ##############################################
    # SCHEMA Payment
    # ##############################################
    Payment:
      type: object
      description: |
        NOTE: payment is deprecated and will be removed on 31st May 2024. Use `payment_multiple_options` instead.
      required:
        - payable
        - currency
        - due_date
        - total_owed
        - type
        - method
        - account
        - reference
      properties:
        payable:
          type: boolean
          description: Toggles whether this content should be payable through Kivra’s payment platform
        status:
          type: string
          description: "Toggles whether this content is paid or unpaid: if already paid the user can’t pay it again through Kivra"
          default: "unpaid"
          readOnly: true
          enum: ["paid", "unpaid"]
        currency:
          type: string
          enum:
            - SEK
          example: "SEK"
          description: |
            Currency used in specifying `total_owed`. In Sweden, only SEK is accepted.
        due_date:
          type: string
          format: ISO8601
          example: "2017-01-01"
          description: Date when this Invoice is due
        total_owed:
          type: string
          format: float
          example: "123.50"
          description: The total amount owed according to the invoice. **If `payable` equals `true` this must be a non negative number that’s greater than or equal to "1"**
        type:
          type: string
          description: Type of format for the reference
          example: "SE_OCR"
          enum: ["SE_OCR", "TENANT_REF"]
        method:
          type: string
          description: 1 = BG and 2 = PG
          example: "1"
          enum: ["1", "2"]
        account:
          type: string
          example: "12345"
          description: Tenant’s account number
        reference:
          type: string
          example: "426523791"
          description: The reference number used for paying. This can be maximum 25 characters long
        variable_amount:
          type: boolean
          default: false
          description: Toggles whether the user may choose to pay only a portion of the total_owed amount or whether the user must always pay the complete total_owed amount
        min_amount:
          type: string
          format: float
          example: "50.00"
          description: The minimum amount that can be paid when `variable_amount` equals `true`. Note that this is a soft limit, so whenever `variable_amount` is `true` the user will be able to choose freely the amount to be paid, but it may be warned if the amount paid is inferior to `min_amount`. `min_amount` must be greater than "0" and less than "total_owed".

    # ##############################################
    # SCHEMA PaymentMultipleOptions
    # ##############################################
    PaymentMultipleOptions:
      type: object
      description: |
        Payment information with the possibility of multiple payment options.
        Note that the first option is special. Notifications about the invoice
        will be based on the due date specified in the first option, and in the
        case where a user looks at the invoice in a client that does not know
        about multiple options, the first one will be the only one presented.
        For example, if the invoice offers the choice of paying the entire debt
        or to start a payment plan, the first option should be to pay the entire
        debt.
      required:
        - payable
        - account
        - method
        - currency
        - options
      properties:
        payable:
          type: boolean
          description: Toggles whether this content should be payable through Kivra’s payment platform. Only `true` is allowed when sending multiple payment options.
          enum: [true]
        status:
          type: string
          description: "Toggles whether this content is paid or unpaid: if already paid the user can’t pay it again through Kivra"
          default: "unpaid"
          readOnly: true
          enum: ["paid", "unpaid"]
        method:
          type: string
          description: 1 = BG and 2 = PG
          example: "1"
          enum: ["1", "2"]
        account:
          type: string
          example: "1234-5678"
          description: |
            The destination account number if the user choses to pay this
            invoice with a service that uses some variety of bank transfer (for
            example, BankGiro or PlusGiro).
        swish_alias:
          type: string
          minLength: 3
          description: |
            The Swish Payee Alias that should be used as the recipient if the
            user choses to pay this invoice with Swish. The alias given must be
            one that is listed as available for the sender, or Swish will not be
            offered as a payment alternative. The value can be the string
            `disable`, in order to override a default payee alias and disable
            Swish payment for this invoice only.
        currency:
          type: string
          enum:
            - SEK
          example: "SEK"
          description: |
            Currency used in specifying `amount`. In Sweden, only SEK is allowed.
        options:
          type: array
          description: "A list of payment options, where each option should differ in either `amount` or `reference`"
          items:
            type: object
            description: "A payment option where each option should differ in either `amount` or `reference`"
            required:
              - due_date
              - amount
              - type
              - reference
            properties:
              due_date:
                type: string
                format: ISO8601
                example: "2017-01-01"
                description: Date when this option is due.
              amount:
                type: string
                format: float
                example: "123.50"
                description: The payment amount for this option. A number larger than or equal to 1.
              type:
                type: string
                description: Type of format for the reference
                example: "SE_OCR"
                enum: ["SE_OCR", "TENANT_REF"]
              reference:
                type: string
                example: "426523791"
                description: The reference number used for paying. This can be maximum 25 characters long.
              title:
                type: string
                description: "Title for this option"
              description:
                type: string
                description: "Optional description for this option"
              icon:
                $ref: "#/components/schemas/PaymentOptionIcon"
        flexible_option:
          type: object
          description: |
            A flexible payment option. This replaces the old variable amount
            functionality. A content with a flexible option must also have at
            least one fixed option, to allow for old clients that don't know how
            to deal with flexible options.
            The flexible option can have up to four limits: suggested maximum
            and minimum, and mandatory maximum and minimum. For the suggested
            limits, the user will be shown a warning when entering a sum outside
            them, but will be allowed to proceeed if they want to. The mandatory
            limits will be enforced, and paying amounts outside them will not be
            allowed. The closest behaviour to that of the old variable amount is
            achieved by setting `max_limit` and `min_suggested`.
          required:
            - due_date
            - type
            - reference
          properties:
            due_date:
              type: string
              format: ISO8601
              example: "2017-01-01"
              description: Date when this option is due.
            type:
              type: string
              description: Type of format for the reference
              example: "SE_OCR"
              enum: ["SE_OCR", "TENANT_REF"]
            reference:
              type: string
              example: "426523791"
              description: The reference number used for paying. This can be maximum 25 characters long.
            title:
              type: string
              description: "Title for this option"
            description:
              type: string
              description: "Optional description for this option"
            icon:
              $ref: "#/components/schemas/PaymentOptionIcon"
            min_limit:
              type: string
              format: float
              example: "123.50"
              description: The smallest allowed amount to be paid. If not given it defaults to 1.00 SEK.
            min_suggested:
              type: string
              format: float
              example: "123.50"
              description: The user is encouraged to pay more than this amount.
            max_suggested:
              type: string
              format: float
              example: "123.50"
              description: The user is encouraged to not pay more than this amount.
            max_limit:
              type: string
              format: float
              example: "123.50"
              description: The largest allowed amount to be paid. Note that even if this amount is not given or very high, limits from the payment provider or bank will still apply.

    # ##############################################
    # SCHEMA CompanyList
    # ##############################################
    CompanyList:
      type: object
      properties:
        key:
          description: "This value is deprecated and will always be set to the empty string."
          type: string
          enum: [""]
          example: ""
        vatnr:
          $ref: "#/components/schemas/VatNumber"

    # ##############################################
    # SCHEMA V2 UserMatch
    # ##############################################
    UserMatchV2SSN:
      required:
        - list
      type: object
      properties:
        list:
          type: array
          items:
            type: string
            example:
              - "191212121212"
              - "197701032380"
              - "198112172385"
          description: list of recipient addresses to be matched
      example:
        list:
          - "191212121212"
          - "197701032380"
          - "198112172385"

    UserMatchV2Email:
      required:
        - list
      type: object
      properties:
        list:
          type: array
          items:
            type: string
            example:
              - "fOO@example.com"
              - "bAr@EXAMPLE.COM"
          description: list of recipient addresses to be matched
      example:
        list:
          - "fOO@example.com"
          - "bAr@EXAMPLE.COM"

    # ##############################################
    # SCHEMA CompanyMatchSet
    # ##############################################
    CompanyMatchSet:
      required:
        - list
      type: object
      properties:
        list:
          type: array
          items:
            type: string
            example:
              - "SE25555555550"
              - "SE25555555551"
              - "SE25555555552"
          description: list of VAT Numbers
      example:
        list:
          - "SE25555555550"
          - "SE25555555551"
          - "SE25555555552"

    # ##############################################
    # SCHEMA Tenant_v2
    # ##############################################
    Tenant_v2:
      type: object
      required:
        - name
        - company_id
      properties:
        name:
          description: Name of the Tenant, this name shows up in the Users Inbox
          type: string
          example: "Kivra"
        company_id:
          type: array
          items:
            $ref: "#/components/schemas/CompanyId"
        edit_security_level:
          description: Security level needed for an enduser to `opt_out` from this Tenant
          type: integer
          readOnly: true
          example: 50
          enum: [25, 50]
        groups:
          type: array
          items:
            type: string
          readOnly: true
          description: List of groups this Tenant belongs to
          example: []
        visibility:
          description: Determines if this Tenant is visible for the enduser
          type: string
          readOnly: true
          enum: [visible, hidden]
        created_at:
          description: Datum when the tenant was created in UTC format
          type: string
          readOnly: true
          example: "2019-05-20T12:42:29Z"
        created_by:
          description: ID of client that created the tenant
          type: string
          readOnly: true
          example: "client_15063298495eafd2749bb78e2f991af3ab023d13df"
        status:
          description: internal field describing whether the user can opt-out the tenant
          type: string
          readOnly: true
          example: "optional"
        class:
          description: internal field
          type: string
          readOnly: true
          example: "opt_out"

    # ##############################################
    # SCHEMA Error40915
    # ##############################################
    Error40915:
      type: object
      properties:
        code:
          type: string
          description: The 5-digits error code
          example: 40915
        short_message:
          type: string
          description: A short message explaining the conflict
          example: Orgnumber already exist
        long_message:
          type: string
          description: A text message explaining the conflict
          example: "One or more of the organisation numbers within the company_id's you provided, already exist in existing tenants. Tenants outside your scope: {Name: TestBolag, Tenant key: 1424780396902ee9278b16417f8e3252c3ced28c38, Organisation number: SE556840226601}"

    # ##############################################
    # SCHEMA Error40045
    # ##############################################
    Error40045:
      type: object
      properties:
        code:
          type: string
          description: The 5-digits error code
          example: 40045
        short_message:
          type: string
          description: A short message explaining the error
          example: PDF was invalid
        long_message:
          type: string
          description: A text message explaining the error
          example: The supplied agreement PDF was invalid. Please check that the file is a valid PDF

    # ##############################################
    # SCHEMA RequestAccess
    # ##############################################
    RequestAccess:
      type: object
      properties:
        created_at:
          description: Datum when the request was created in UTC format
          type: string
          readOnly: true
          example: "2019-05-20T12:42:29Z"
        created_by:
          description: ID of client that created the request
          type: string
          readOnly: true
          example: "client_15063298495eafd2749bb78e2f991af3ab023d13df"
        status:
          description: status of the request, for instance `pending`, `accepted` or `rejected`
          type: string
          readOnly: true
          example: "pending"
        client_id:
          description: ID Of You the Client
        client_name:
          description: Name of the client who created the requested tenant
          type: string
          readOnly: true
          example: "Client XYZ"
        tenant_name:
          description: Name of the requested tenant
          type: string
          readOnly: true
          example: "Tenant ABC"
        tenant_key:
          description: Key of the requested tenant
          type: string
          readOnly: true
          example: "1424780396902ee9278b16417f8e3252c3ced28c38"

    # ##############################################
    # SCHEMA Agreement
    # ##############################################
    Agreement:
      type: object
      required:
        - subject
        - type
        - original
        - parties
      properties:
        subject:
          description: Name of the agreement
          type: string
          example: "Employment agreement"
        type:
          description: the type of content, for agreements always use 'agreement'
          type: string
          example: "agreement"
        vat_number:
          description: |
            A valid VAT-identifier, Swedish format: `SE[xxxxxxxxxx]01`
          type: string
          example: SE556840226601
        original:
          type: object
          properties:
            name:
              description: Name of the document file
              type: string
              example: "agreement1025.pdf"
            content_type:
              description: The [IANA](http://www.iana.org/assignments/media-types/media-types.xhtml) media type corresponding to the file, e.g. "application/pdf"
              type: string
              example: "application/pdf"
            data:
              description: Base64-encoded data for the agreement PDF
              type: string
              format: "Base64-encoded data"
              example: REVBREJFRUY=
        parties:
          description: list of signers and delegates that are requested to sign the agreement
          type: array
          items:
            $ref: "#/components/schemas/AgreementParties"
          example:
            - ssn: "197701032380"
              name: "Jan-Erik Karlsson"
              email: "je.karlsson@email.nu"
              role: "signer"
            - ssn: "198112172385"
              name: "Gustav Larsson"
              email: "gustav123@mymail.com"
              role: "delegate"

    # ##############################################
    # SCHEMA AgreementParties
    # ##############################################
    AgreementParties:
      type: object
      properties:
        ssn:
          description: |
            User's unique SSN, format: `YYYYMMDDnnnn`
          type: string
          example: "197701032380"
        name:
          description: Name of the user
          type: string
          example: "Jan-Erik Karlsson"
        email:
          description: email to be used to contact the user
          type: string
          example: "je.karlsson.hem@email.nu"
        role:
          description: the role of the user in this signature flow
          type: string
          enum: ["signer", "delegate"]
          example: "signer"

    # ##############################################
    # SCHEMA AgreementStateShort
    # ##############################################
    AgreementStateShort:
      type: object
      properties:
        key:
          description: unique agreement id
          type: string
          example: "1544707148d73a3e84a216427724637fc207cba2ab"
        state:
          description: current state for the agreement
          type: string
          example: "active"
          enum: [active, generating, completed, revoked]
          readOnly: true

    # ##############################################
    # SCHEMA AgreementStateDetailed
    # ##############################################
    AgreementStateDetailed:
      type: object
      properties:
        subject:
          description: Name of the agreement
          type: string
          example: "Employment agreement"
        created_at:
          description: The time when the agreement was created
          type: string
          example: "2019-04-09T13:42:26Z"
          readOnly: true
        expires_at:
          description: |
            The expiration time for the agreement, if the agreement is not completed before this date, it will no longer be available for signature
          type: string
          example: "2019-05-09T13:42:26Z"
          readOnly: true
        state:
          description: The current state of the agreement
          type: string
          example: completed
          enum: [active, generating, completed, revoked]
          readOnly: true
        tenant_name:
          description: The name of the tenant that created the agreement
          type: string
          example: "Sender AB"
        tenant:
          description: The tenant key that created the agreement
          type: string
          example: "tenant_154442474745511bbaaa5b44b391eae0513e2c55a0"
        type:
          description: The type of agreement as provided by the sender when the agreement was created
          type: string
          example: "agreement"
        signatures:
          description: |
            List of signatures
          type: array
          readOnly: true
          items:
            $ref: "#/components/schemas/AgreementSignature"
          example:
            - ssn: "197701032380"
              real_name: "Jan-Erik Karlsson"
              created_at: "2019-04-12T08:23:29Z"
              order_ref: "d4ace777-6b91-4172-903e-39371ede89f1"
            - ssn: "198112172385"
              real_name: "Gustav Johan Larsson"
              created_at: "2019-04-11T18:53:03Z"
              order_ref: "f5bce777-0b42-4222-1f3e-ab523ede7a5f"
        parties:
          description: list of signers and delegates that are requested to sign the agreement
          type: array
          items:
            $ref: "#/components/schemas/AgreementParties"
          example:
            - ssn: "197701032380"
              name: "Jan-Erik Karlsson"
              email: "je.karlsson.hem@email.nu"
              role: "signer"
            - ssn: "198112172385"
              name: "Gustav Larsson"
              email: "gustav123@mymail.com"
              role: "delegate"

    # ##############################################
    # SCHEMA AgreementSignature
    # ##############################################
    AgreementSignature:
      type: object
      properties:
        ssn:
          description: |
            Signer's unique SSN, format: `YYYYMMDDnnnn`
          type: string
          example: "191212121212"
        real_name:
          description: The real name of the signer, as provided by Mobile BankID service
          type: string
          example: "Jan-Erik Karlsson"
        created_at:
          description: The time when the signature was created
          type: string
          example: "2019-04-12T08:23:29Z"
        order_ref:
          description: The unique ID of the signature
          type: string
          example: "d4ace777-6b91-4172-903e-39371ede89f1"

    # ##############################################
    # SCHEMA CompanyId
    # ##############################################
    CompanyId:
      type: object
      required:
        - name
        - orgnr
      properties:
        name:
          description: Legal name of Company
          type: string
          example: "Kivra AB"
        orgnr:
          description: Vat number of Company
          type: string
          example: "SE556840226601"

    # ##############################################
    # SCHEMA File
    # ##############################################
    File:
      type: object
      required:
        - name
        - data
        - content_type
      properties:
        name:
          description: Arbritrary file-name that is shown alongside the File in the Kivra GUI
          type: string
          example: filename.pdf
        data:
          description: Base64-encoded data
          type: string
          format: "Base64-encoded data"
          example: REVBREJFRUY=
        content_type:
          description: The [IANA](http://www.iana.org/assignments/media-types/media-types.xhtml) media type corresponding to the file, e.g. "application/pdf"
          type: string
          example: "application/pdf"

    # ##############################################
    # SCHEMA Parts_Responsive
    # ##############################################
    Parts_Responsive:
      type: object
      required:
        - name
        - data
        - content_type
      properties:
        name:
          description: Arbritrary file-name
          type: string
          example: document.pdf
        data:
          description: Base64-encoded data for the PDF content
          type: string
          format: "Base64-encoded data"
          example: REVBREJFRUY=
        content_type:
          description: The [IANA](http://www.iana.org/assignments/media-types/media-types.xhtml) media type for PDF files "application/pdf"
          type: string
          example: "application/pdf"
        responsive_part:
          type: object
          required:
            - name
            - data
            - content_type
          properties:
            name:
              description: Arbritrary file-name
              type: string
              example: document.html
            data:
              description: Base64-encoded data for the HTML document
              type: string
              format: "Base64-encoded HTML data"
              example: PGgxPmNvbnRlbnQgMTwvaDE+CjxwPmNvbnRlbnQgMTwvcD4=
            content_type:
              description: The [IANA](http://www.iana.org/assignments/media-types/media-types.xhtml) media type for HTML content "text/html"
              type: string
              example: "text/html"

    # ##############################################
    # SCHEMA Icon
    # ##############################################
    Icon:
      type: object
      required:
        - data
        - content_type
      properties:
        name:
          description: Arbitrary filename
          type: string
          example: filename.pdf
        data:
          description: >
            Base64-encoded data. Max size is 134 kB when encoded which is roughly equivalent to
            100 kB before encoding. The image format must be PNG.
            The image must be quadratic (that is, width and height
            must be the same). The sides must be at least 256
            pixels long, and at most 512 pixels long. The image
            must have an alpha channel.
          type: string
          format: "Base64-encoded data"
          example: REVBREJFRUY=
        content_type:
          description: The [IANA](http://www.iana.org/assignments/media-types/media-types.xhtml) media type corresponding to the file, e.g. "image/png"
          type: string
          enum: ["image/png"]
          example: "image/png"

    # ##############################################
    # SCHEMA TenantIcon
    # ##############################################
    TenantIcon:
      allOf:
        - $ref: "#/components/schemas/Icon"
        - type: object
          properties:
            data:
              description: Base64-encoded data
              type: string
              format: "Base64-encoded data"
              example: REVBREJFRUY=

    # ##############################################
    # SCHEMA PaymentOptionIcon
    # ##############################################
    PaymentOptionIcon:
      allOf:
        - $ref: "#/components/schemas/Icon"
        - type: object
          properties:
            data:
              # TODO: Actually decide max before merging this PR
              description: This string is ignored by the documentation system
              type: string
              example: REVBREJFRUY=

    # ##############################################
    # SCHEMA CompanyInbox
    # ##############################################
    CompanyInbox:
      type: object
      properties:
        key:
          description: Content's unique key
          type: string
          example: "15294092505b9cfab3f79d233f8eca6fbc5385fa61"
        sender:
          description: Unique key for the tenant that posted the content
          type: string
          example: "1341573157b3a133f220f4217b2e32989d2efa015"
        sender_name:
          description: Name of the tenant that posted the content
          type: string
          example: "Kivra"
        created_at:
          description: Date and time when the content was delivered to the recipient
          type: string
          example: "2018-06-19T11:54:10Z"
        subject:
          description: Subject of the content, as set by the sender
          type: string
          example: "Invoice 4512 from Local Bank"
        status:
          description: Whether the content has been read (opened) or not
          type: string
          enum: ["read", "unread"]
          example: "read"

    # ##############################################
    # SCHEMA CompanyContent
    # ##############################################
    CompanyContent:
      type: object
      properties:
        sender:
          description: Unique key for the tenant that posted the content
          type: string
          example: "1341573157b3a133f220f4217b2e32989d2efa015"
        sender_name:
          description: Name of the tenant that posted the content
          type: string
          example: "Kivra"
        created_at:
          description: Date and time when the content was delivered to the recipient
          type: string
          example: "2018-06-19T11:54:10Z"
        subject:
          description: Subject of the content, as set by the sender
          type: string
          example: "Invoice 4512 from Local Bank"
        receiver_name:
          description: Name of the company that received the content
          type: string
          example: "Digital Hero AB"
        payment:
          $ref: "#/components/schemas/Payment"
        parts:
          description: files composing the content
          type: array
          items:
            $ref: "#/components/schemas/Parts"

    # ##############################################
    # SCHEMA Booking
    # ##############################################
    Booking:
      type: object
      required:
        - title
        - start_time
      properties:
        title:
          description: |
            Booking name that is used when creating a post in an external calendar. Note! Don’t include any personal or sensitive information here.
          type: string
          example: "Kontroll av tandhälsa"
        start_time:
          description: |
            Date and time for the booking to start. Must be in the future. If the time zone is not stated it will be set to UTC.
          type: string
          format: ISO8601
          example: "2028-06-19T11:00:00Z"
        end_time:
          description: |
            Date and time for the booking to end. If present must be after start_time. If the time zone is not stated it will be set to UTC.
          type: string
          format: ISO8601
          example: "2028-06-19T12:00:00Z"
        location:
          description: Location for the appointment/booking. Address must contain city for full functionality.
          type: string
          example: "Strandvägen 61, Stockholm"
        description:
          description: |
            Additional information. Note! Don’t include any personal or sensitive information here.
          type: string
          example: "Brush your teeth before coming"
        info_url:
          description: Link to page with additional information. The url must use the secure HTTPS protocol
          type: string
          format: uri

    # ##############################################
    # SCHEMA Form
    # ##############################################
    Form:
      required:
        - id
        - days_to_expiry
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: The form template key
          example: 2877d684-a340-4e4c-867f-d93283787b01
        sender_reference:
          type: object
          description: Reference data you want to include in the form response.
          example:
            internal_id: "6eb7d1b9-ccd6-408f-ade7-9a1837be3ecf"
        days_to_expiry:
          type: integer
          minimum: 1
          maximum: 90
          description: >
            Number of days in which a response to the form can be submitted
            (until 23:59:59).

            As an *example*, if *the content is sent* on September 8th,
            and the form expires in 30 days, it will effectively expire
            on October 7th 23:59:59.
          example: 30

    # ##############################################
    # SCHEMA Invoice
    # ##############################################
    Invoice:
      type: object
      required:
        - total_amount_due
        - currency
      anyOf:
        - title: Invoice
          required: [due_date]
          anyOf:
            - title: bankgiro
              required: [bankgiro]
            - title: plusgiro
              required: [plusgiro]
        - title: Invoice Reminder
          required: [due_date]
          anyOf:
            - title: bankgiro
              required: [bankgiro]
            - title: plusgiro
              required: [plusgiro]
        - title: Invoice Credit note
      properties:
        total_amount_due:
          type: string
          format: float
          example: "1250.00"
        currency:
          type: string
          format: "ISO4217"
          description: "ISO 4217 currency code (3 uppercase letters)"
          example: "SEK"
        due_date:
          type: string
          description: "YYYY-MM-DD"
          example: "2026-11-30"
        bankgiro:
          type: string
          example: "123-4567"
        plusgiro:
          type: string
          example: "456-9999"
        invoice_number:
          type: string
          example: "INV-2024-001"
          description: "Alphanumeric invoice identifier assigned by the supplier"
        original_invoice_number:
          type: string
          example: "INV-2023-999"
          description: "Reference to another invoice"
        invoice_date:
          type: string
          description: "YYYY-MM-DD"
          example: "2026-10-31"
        buyer_reference:
          type: string
          example: "REF-12345"
        order_number:
          type: string
          example: "ORD-2024-789"
        supplier_name:
          type: string
          example: "Supplier AB"
        supplier_organisation_number:
          type: string
          example: "556123-4567"
        supplier_vat_number:
          type: string
          example: "SE556123456701"
        supplier_address_street:
          type: string
          example: "Stora gatan 123"
        supplier_address_postal_code:
          type: string
          example: "11122"
        supplier_address_city:
          type: string
          example: "Stockholm"
        payment_reference:
          type: object
          required:
            - value
            - reference_type
          properties:
            value:
              type: string
            reference_type:
              type: string
              enum:
                - "ocr"
                - "unstructured"
          example:
            payment_reference:
              value: "426523791"
              reference_type: "ocr"
        iban:
          type: string
          example: "SE3550000000054910000003"
        bic:
          type: string
          example: "ESSESESS"
        total_amount_tax_exclusive:
          type: string
          format: float
          example: "1000.00"
        total_amount_tax_inclusive:
          type: string
          format: float
          example: "1250.00"
        total_vat_amount:
          type: string
          format: float
          example: "250.00"
        rounding_amount:
          type: string
          format: float
          example: "0.00"

    # ##############################################
    # SCHEMA InviteResearch
    # ##############################################
    InviteResearch:
      type: object
      required:
        - description
        - uri
        - expires_at
        - behalf_of
      properties:
        title:
          type: string
        description:
          type: string
          description: longer description
          example: |
            This is the heavy heavy monster sound
            The nuttiest sound around
        uri:
          type: string
          description: The uri to open when the user clicks the invitation. The uri must use the secure HTTPS protocol
          example: https://example.com
        behalf_of:
          type: object
          nullable: true
          description: Who this research is conducted on behalf of
          required:
            - name
            - vat_number
          properties:
            name:
              type: string
              description: Something
              example: Test Inc
            vat_number:
              type: string
              description: A Swedish VAT number ("momsregistreringsnummer").
              example: "SE556840226601"
        expires_at:
          description: |
            The expiration time for the survey, after this date, it will no longer be available.
          type: string
          nullable: true
          example: "2024-05-09T13:42:26Z"
    # ##############################################
    # SCHEMA InviteGift
    # ##############################################
    InviteGift:
      type: object
      required:
        - uri
        - expires_at
        - behalf_of
      properties:
        uri:
          type: string
          description: The uri to open when the user clicks the invitation. The uri must use the secure HTTPS protocol
          example: https://example.com
        behalf_of:
          type: object
          nullable: true
          description: Who this gift is conducted on behalf of
          required:
            - name
            - vat_number
          properties:
            name:
              type: string
              description: Something
            vat_number:
              type: string
              description: A Swedish VAT number ("momsregistreringsnummer").
        expires_at:
          description: |
            The expiration time for the gift, after this date, it will no longer be available.
          type: string
          nullable: true
          example: "2024-05-09T13:42:26Z"

    # ##############################################
    # SCHEMA InviteVoucher
    # ##############################################
    InviteVoucher:
      type: object
      required:
        - uri
        - expires_at
        - behalf_of
      properties:
        store:
          type: object
          description: Where this voucher valid
          required:
            - name
          properties:
            name:
              type: string
        uri:
          type: string
          description: The uri to open when the user clicks the invitation. The uri must use the secure HTTPS protocol
          example: https://example.com
        behalf_of:
          type: object
          nullable: true
          description: Who this voucher is conducted on behalf of
          required:
            - name
            - vat_number
          properties:
            name:
              type: string
              description: Test AB
            vat_number:
              type: string
              description: A Swedish VAT number ("momsregistreringsnummer").
        expires_at:
          description: |
            The expiration time for the voucher, after this date, it will no longer be available.
          type: string
          nullable: true
          example: "2024-05-09T13:42:26Z"

    # ##############################################
    # SCHEMA InviteSign
    # ##############################################
    InviteSign:
      type: object
      required:
        - uri
        - expires_at
        - behalf_of
        - service_provider
      properties:
        service_provider:
          type: object
          description: The service provider used for signing the document
          required:
            - name
          properties:
            name:
              type: string
        uri:
          type: string
          description: The uri to open when the user clicks the document. The uri must use the secure HTTPS protocol
          example: https://example.com
        behalf_of:
          type: object
          nullable: true
          description: Who this document is delivered on behalf of
          required:
            - name
            - vat_number
          properties:
            name:
              type: string
              description: Test AB
            vat_number:
              type: string
              description: A Swedish VAT number ("momsregistreringsnummer").
        expires_at:
          description: |
            The expiration time for the document to be signed, after this date, it will no longer be available.
          type: string
          nullable: true
          example: "2024-05-09T13:42:26Z"
        description:
          type: string
          description: Additional information. Note! Don't include any personal or sensitive information here.

    # ##############################################
    # SCHEMA Signed
    # ##############################################
    Signed:
      type: object
      required:
        - behalf_of
      properties:
        behalf_of:
          type: object
          nullable: true
          description: Who this document is delivered on behalf of
          required:
            - name
            - vat_number
          properties:
            name:
              type: string
              description: Test AB
            vat_number:
              type: string
              description: A Swedish VAT number ("momsregistreringsnummer").

    # ##############################################
    # SCHEMA InviteKyc
    # ##############################################
    InviteKyc:
      type: object
      required:
        - description
        - uri
        - expires_at
        - behalf_of
        - service_provider
      properties:
        title:
          type: string
          nullable: true
          description: Title to present
          example: Hey you, dont watch that, watch this
        description:
          type: string
          description: longer description
          example: |
            This is the heavy heavy monster sound
            The nuttiest sound around
        uri:
          type: string
          description: The uri to open when the user clicks the invitation. The uri must use the secure HTTPS protocol
          example: https://example.com
        behalf_of:
          type: object
          nullable: true
          description: Who this KYC invite is conducted on behalf of
          required:
            - name
            - vat_number
          properties:
            name:
              type: string
              description: Something
              example: Test Inc
            vat_number:
              type: string
              description: A Swedish VAT number ("momsregistreringsnummer").
              example: "SE556840226601"
        expires_at:
          description: |
            The expiration time for the survey, after this date, it will no longer be available.
          type: string
          nullable: true
          example: "2024-05-09T13:42:26Z"
        service_provider:
          type: object
          description: The service provider
          required:
            - name
          properties:
            name:
              type: string

    # ##############################################
    # SCHEMA Registered letter
    # ##############################################
    RegisteredLetter:
      type: object
      required:
        - expires_at
        - hidden
      properties:
        expires_at:
          type: string
          format: ISO8601
          description: When the registered letter expires, max 30 days from now.<br>- Time will always be set to end-of-day, regardless of whether time is specified or not.
        hidden:
          type: object
          required:
            - sender
            - subject
          description: Specifies which fields that should be hidden in the Kivra Inbox.
          properties:
            sender:
              type: boolean
              description: False if the sender name and icon should be shown in the Kivra Inbox.
            subject:
              type: boolean
              description: False if the subject should be shown in the Kivra Inbox.
        sender_reference:
          type: object
          nullable: true
          description: Any reference that the sender might want to include.

    # ##############################################
    # SCHEMA Campaign
    # ##############################################
    Campaign:
      type: object
      required:
        - tag
      properties:
        tag:
          type: string
          description: The tag that refers to the campaign that you want to attach. Note that the request will still be processed even if the campaign does not exist.
          example: summer_2023

    # ##############################################
    # SCHEMA Parts
    # ##############################################
    Parts:
      type: object
      properties:
        content_type:
          type: string
          description: The IANA media type corresponding to the file, e.g. "application/pdf"
          example: "application/pdf"
        checksum:
          type: string
          description: The cheksum of the document calculated with md5
          example: "9209c7eebdd283a4c4bd7555e73e6064"
        sha256:
          type: string
          description: hash of the document calculated with SHA-256
          example: "287f2fe67a8a76a10169aa6a885d21e1f83416c4831294ea5c4b0a38bda5c78d"
        size:
          type: integer
          description: size of the document in bytes
          example: 163414
        body:
          type: string
          description: body of the content (present only if content_type is "text/html" or "text/plain")
          example: "<!doctype html>\n<html class=\"...."
        key:
          type: string
          description: |
            The unique key for the content file (present for all content that is not "text/html" or "text/plain")
          example: "15118724482475bf32615b4a2aaa604fd66377010e"

    # ##############################################
    # SCHEMA EmptyString
    # ##############################################
    EmptyString:
      description: The empty string
      enum:
        - ""
      type: string

    # ##############################################
    # SCHEMA SenderContactInfo
    # ##############################################
    SenderContactInfo:
      type: object
      description: Contact information for the sender. Null if not provided or all fields are null.
      nullable: true
      properties:
        email_address:
          type: string
          nullable: true
          description: Email address for support.
          example: "support@example.com"
        logo_url:
          type: string
          format: url
          nullable: true
          description: URL to a logo.
          example: "https://example.com/logo.png"
        phone_number:
          type: string
          nullable: true
          description: Phone number for support.
          example: "+46700000000"
        text:
          type: string
          nullable: true
          description: Free-form text, e.g., contact person or department.
          example: "Customer Support"
        url:
          type: string
          format: url
          nullable: true
          description: URL to a support page.
          example: "https://example.com/support"
      example:
        email_address: "support@example.com"
        logo_url: "https://example.com/logo.png"
        phone_number: "+46700000000"
        text: "Customer Support"
        url: "https://example.com/support"

    # ##############################################
    # SCHEMA CompanyKey
    # ##############################################
    CompanyKey:
      description: The key for a company
      pattern: ^[0-9]{10}[a-f0-9]{32}$
      example: 156077433683911cdca5fd4563bded979572454cb9
      type: string

    # ##############################################
    # SCHEMA ContentKey
    # ##############################################
    ContentKey:
      description: The key for a content
      pattern: ^[0-9]{10}[a-f0-9]{32}$
      example: 156077433683911cdca5fd4563bded979572454cb9
      type: string

    # ##############################################
    # SCHEMA CompanyType
    # ##############################################
    CompanyType:
      description: |
        The company's/organisation's type

        This is currently based on the registry holding the signatory
        information. Thus `company` really means that Bolagsverket is the
        registry and includes Ekonomiska föreningar as well. For
        `riksidrottsförening` it is Riksindrottsförbundet.
      example: company
      enum:
        - company
        - riksidrottsförening
      type: string

    # ##############################################
    # SCHEMA CompanyName
    # ##############################################
    CompanyName:
      description: The name of a company
      example: Cornelias Café AB
      type: string

    # ##############################################
    # SCHEMA VatNumber
    # ##############################################
    VatNumber:
      pattern: ^SE[0-9]{10}01$
      description: A Swedish VAT number ("momsregistreringsnummer").
      example: SE556000475501
      type: string

    # ##############################################
    # SCHEMA IncomingEmail
    # ##############################################
    IncomingEmail:
      pattern: ^[a-tv-zA-TV-Z0-9]{9}@(sandbox\.)?kivramail.com$
      description: Email address for receiving emails as content
      type: string
      example: xxcsn2psy@kivramail.com

    # ##############################################
    # SCHEMA ScanningAddress
    # ##############################################
    ScanningAddress:
      description: Postal address for receiving physical mail as scanned content in Kivra.
      nullable: true
      additionalProperties: false
      properties:
        name:
          $ref: "#/components/schemas/CompanyName"
        street:
          description: |
            A special "street" that allows the scanning facility to send to the correct company.

            It's on the format "Kivra: <organisation number>"
          type: string
          example: "Kivra: 556000-4755"
        postal_code:
          description: |
            The special postal code that goes to Kivra's scanning facility
          example: 106 31
          enum:
            - 106 31
          type: string
        city:
          description: The "city" for Kivra's scanning facility
          example: Stockholm
          enum:
            - Stockholm
          type: string
        country:
          description: The country for Kivra's scanning facility
          example: SE
          enum:
            - SE
          type: string
      required:
        - name
        - street
        - postal_code
        - city
        - country
      type: object

    # ##############################################
    # SCHEMA ScanningFallbackAddress
    # ##############################################
    ScanningFallbackAddress:
      description: If a mailpiece cannot be scanned, it will be forwarded to this address instead.
      nullable: true
      additionalProperties: false
      properties:
        name:
          description: Name of the recipient (a company or person).
          type: string
          example: "Cornelias Café AB"
        street:
          description: Name of the street, including street number.
          type: string
          example: "Klara Norra kyrkogata 33"
        postal_code:
          description: Postal code.
          example: "11122"
          type: string
        city:
          description: Name of the city.
          example: "Stockholm"
          type: string
        country:
          description: Name of the country.
          example: "Sverige"
          type: string
        care_of:
          description: Address care of (c/o).
          example: ""
          type: string
      required:
        - name
        - street
        - postal_code
        - city
        - country
        - care_of
      type: object

    # ##############################################
    # SCHEMA AllServices
    # ##############################################
    AllServices:
      description: |
        The status of each Kivra Business and Kivra Business Plus service
        for the company.
      additionalProperties: false
      properties:
        email:
          description: Indicates if the Kivra email service is active
          example: false
          type: boolean
        scanning:
          description: Indicates if the scanned mail service is active
          example: false
          type: boolean
        interpreter:
          deprecated: true
          description: |
            Used to indicate if the interpreter service is active. Now it is
            always false.
          example: false
          type: boolean
        kivra:
          description: Indicates that the Kivra digital mail service is active (always true)
          example: true
          enum:
            - true
          type: boolean
        minameddelanden:
          description: |
            Indicates if the Kivra public authority mail service is active.
          example: true
          type: boolean
      type: object

    # ##############################################
    # SCHEMA FieldQueryParameter
    # ##############################################
    FieldQueryParameter:
      description: The field(s) to respond with
      example: key
      type: string

    # ##############################################
    # SCHEMA BaseCompany
    # ##############################################
    BaseCompany:
      description: A company object with basic fields only
      additionalProperties: false
      properties:
        key:
          $ref: "#/components/schemas/CompanyKey"
        name:
          $ref: "#/components/schemas/CompanyName"
        type:
          $ref: "#/components/schemas/CompanyType"
        vat_number:
          $ref: "#/components/schemas/VatNumber"
      type: object

    # ##############################################
    # SCHEMA FullCompany
    # ##############################################
    FullCompany:
      description: A company object.
      additionalProperties: false
      properties:
        key:
          $ref: "#/components/schemas/CompanyKey"
        scanning_address:
          $ref: "#/components/schemas/ScanningAddress"
        scanning_fallback_address:
          $ref: "#/components/schemas/ScanningFallbackAddress"
        created_at:
          description: When the company started to onboard.
          example: "2019-02-26T14:47:26Z"
          type: string
          format: date-time
        email:
          description: |
            Email address for receiving emails as content.
            Empty if the Kivra email service is not active.
          oneOf:
            - $ref: "#/components/schemas/IncomingEmail"
            - $ref: "#/components/schemas/EmptyString"
        name:
          $ref: "#/components/schemas/CompanyName"
        type:
          $ref: "#/components/schemas/CompanyType"
        services:
          $ref: "#/components/schemas/AllServices"
        vat_number:
          $ref: "#/components/schemas/VatNumber"
      required:
        - key
      type: object

    # ##############################################
    # SCHEMA GovernmentalLabel
    # ##############################################
    GovernmentalLabel:
      description: |
        Indicates if the content comes from a governmental body.
      type: boolean

    # ##############################################
    # SCHEMA HandledLabel
    # ##############################################
    HandledLabel:
      description: |
        The content has been marked as `handled`, previously known as `paid`.
      type: boolean

    # ##############################################
    # SCHEMA InterpretedLabel
    # ##############################################
    InterpretedLabel:
      deprecated: true
      description: |
        Used to indicate if the content has been interpreted. Now it is always
        set to `false`.
      type: boolean
      example: false

    # ##############################################
    # SCHEMA ReminderLabel
    # ##############################################
    ReminderLabel:
      description: |
        Indicates if the content, which must be an invoice, is a reminder.
      type: boolean

    # ##############################################
    # SCHEMA TrashedLabel
    # ##############################################
    TrashedLabel:
      description: |
        Indicates if the content has been moved to the trash.
      type: boolean

    # ##############################################
    # SCHEMA ViewedLabel
    # ##############################################
    ViewedLabel:
      description: |
        The content has been viewed. This can be toggled by the user, i.e. "Mark
        as unread".
      type: boolean

    # ##############################################
    # SCHEMA InterpretedFields
    # ##############################################
    InterpretedFields:
      deprecated: true
      description: |
        Used to indicate which fields, in dot notation, have been interpreted.
        Now it is always set to the empty array.
      type: array
      items:
        type: string
      example: []

    # ##############################################
    # SCHEMA PartnerPaymentOption
    # ##############################################
    PartnerPaymentOption:
      description: One way to pay this invoice
      additionalProperties: false
      properties:
        account:
          description: The account to pay to
          example: "12345678"
          type: string
          nullable: true
        amount:
          minimum: 0
          description: The amount to pay in öre, or equivalent
          example: 150000
          type: integer
          nullable: true
        currency:
          description: The currency used for this payment option
          example: SEK
          type: string
          nullable: true
        description:
          description: The description of this payment option
          example: 12 month subscription
          type: string
          nullable: true
        due_at:
          description: Due date of this payment option
          example: "2022-03-30T00:00:00Z"
          type: string
          format: date-time
          nullable: true
        interpreted:
          deprecated: true
          description: |
            Used to indicate if this payment option was interpreted. Now it is
            always set to `false`.
          example: false
          type: boolean
        reference:
          description: |
            The payments reference, could be an OCR number or invoice reference
          example: 987654321
          type: string
          nullable: true
        reference_type:
          description: The type of reference
          example: OCR
          type: string
          nullable: true
        type:
          description: The type of the the payment, aka the type of the account
          example: bankgiro
          type: string
          nullable: true
        vat_amount:
          description: The VAT in öre for this invoice, if available
          example: 1500
          type: integer
          nullable: true
      required:
        - account
        - amount
        - currency
        - description
        - due_at
        - interpreted
        - reference
        - reference_type
        - type
        - vat_amount
      type: object

    # ##############################################
    # SCHEMA InvoiceReferences
    # ##############################################
    InvoiceReferences:
      description: References for this invoice
      additionalProperties: false
      nullable: true
      properties:
        our:
          description: Our reference, "vår referens" in Swedish
          type: string
          nullable: true
          example: "Gustav Larsson"
        your:
          description: Your reference, "er referens" in Swedish
          type: string
          nullable: true
          example: null
      required:
        - our
        - your
      type: object

    # ##############################################
    # SCHEMA PartQueryParameter
    # ##############################################
    PartQueryParameter:
      minimum: 1
      description: The content part to retrive, 1-indexed
      type: integer

    # ##############################################
    # SCHEMA PartMetadata
    # ##############################################
    PartMetadata:
      additionalProperties: false
      properties:
        content_type:
          description: The MIME type of this content part
          enum:
            - application/pdf
            - text/html
            - text/plain
            - image/jpeg
            - image/gif
            - image/png
            - text/calendar
            - application/msword
            - >-
                application/vnd.openxmlformats-officedocument.wordprocessingml.document
            - >-
                application/vnd.openxmlformats-officedocument.wordprocessingml.template
          type: string
        name:
          description: The name of this content part. Usually a filename.
          type: string
          example: faktura.pdf
        sha256:
          description: The SHA256 digest of this content part. For older content, received before early 2018, this may be `null`.
          type: string
          example: 060bed374498fe2f36a5f2e1abf217a90beb46e8fe4ec1d9d5ce7746
          nullable: true
        size:
          minimum: 0
          description: The size in bytes of this content part
          type: integer
          example: 4711
        url:
          description: The URL to fetch this content part
          type: string
          example: "https://sender.sandbox-api.kivra.com/v3/partner/company/1691677086a57b73569d594df5abad7fd2575c1070/content/1691677075a9813e08f783496382b0bff743ec34ae?part=1"
        responsive_body:
          description: The responsive content HTML of the part, if and only if this part has a corresponding responsive part
          type: string
          example: "<h1>Faktura</h1>\n<p>Totalt: 1 500,00 kr/p>"
      required:
        - content_type
        - name
        - sha256
        - size
        - url
      type: object

    # ##############################################
    # SCHEMA ContentPart
    # ##############################################
    ContentPart:
      description: |
        The file data of the content part, `content_type` in the part metadata
        describes its file type.

    # ##############################################
    # SCHEMA ContentOrigin
    # ##############################################
    ContentOrigin:
      description: |
        The origin of the content. Indicates how the content was delivered to Kivra.
        - `kivra`: Sent directly through Kivra.
        - `minameddelanden`: Sent via Mina Meddelanden. Used by governmental organisations.
        - `user`: Uploaded by an user.
        Companies with Kivra företag+ can also receive:
        - `physical`: Physical post scanned by Kivra.
        - `email`: Sent via the company's kivramail.com email address.
      type: string
      enum:
        - kivra
        - minameddelanden
        - user
        - physical
        - email

    # ##############################################
    # SCHEMA BaseContentMetadata
    # ##############################################
    BaseContentMetadata:
      description: Listing summary of content metadata
      additionalProperties: false
      properties:
        created_at:
          description: |
            This is the same date and time as `transaction_at`, except for
            reminder invoices, where it is the reminder date and not the
            original invoice date.
          type: string
          format: date-time
          nullable: false
        key:
          $ref: "#/components/schemas/ContentKey"
        labels:
          description: The labels that apply to this content
          additionalProperties: false
          properties:
            governmental:
              $ref: "#/components/schemas/GovernmentalLabel"
            handled:
              $ref: "#/components/schemas/HandledLabel"
            interpreted:
              $ref: "#/components/schemas/InterpretedLabel"
            reminder:
              $ref: "#/components/schemas/ReminderLabel"
            trashed:
              $ref: "#/components/schemas/TrashedLabel"
            viewed:
              $ref: "#/components/schemas/ViewedLabel"
          required:
            - governmental
            - handled
            - interpreted
            - reminder
            - trashed
            - viewed
          type: object
        parts:
          type: array
          items:
            $ref: "#/components/schemas/PartMetadata"
        received_at:
          description: When the content was received by Kivra
          type: string
          format: date-time
        receiver_name:
          description: The name of the recipient company
          type: string
          example: Developers Developers Developers AB
        receiver_vat_number:
          $ref: "#/components/schemas/VatNumber"
        sender_icon_url:
          type: string
          example: "https://sandbox-static.kivra.com/img/tenant/1341573157b3a1c55f220f4007b2e44789d2d04015/icon.png"
          format: url
          description: A url to the icon used by the sender within Kivra, or `null` if no corresponding icon exists.
          nullable: true
        sender_name:
          description: The name of the sender
          example: Lenas Konditori AB
          type: string
          nullable: true
        sender_vat_numbers:
          description: VAT numbers representing the sender
          type: array
          items:
            $ref: "#/components/schemas/VatNumber"
          nullable: true
        origin:
          $ref: "#/components/schemas/ContentOrigin"
        subject:
          description: Subject of the content
          example: "Invoice: a thousand Swiss rolls"
          type: string
        transaction_at:
          description: |
            The date and time this content conceptually took place.

            + For a normal `invoice` it is the invoice date.
            + For a reminder `invoice` it the original invoice date and not
              the reminders invoice date.
            + For all `other` types of content it is `null`.
            + If no date could be found, it is `null`.
          type: string
          format: date-time
          nullable: true
        type:
          description: The type of the content
          enum:
            - invoice
            - other
          type: string
      required:
        - created_at
        - key
        - labels
        - parts
        - received_at
        - receiver_name
        - receiver_vat_number
        - sender_icon_url
        - sender_name
        - sender_vat_numbers
        - subject
        - transaction_at
        - type
      type: object

    # ##############################################
    # SCHEMA FullContentMetadata
    # ##############################################
    FullContentMetadata:
      description: Details of content metadata
      allOf:
        - type: object
          properties:
            interpreted_fields:
              $ref: "#/components/schemas/InterpretedFields"
            parts:
              description: The files in the content
              type: array
              items:
                $ref: "#/components/schemas/PartMetadata"
            payment_options:
              description: Different ways to pay an invoice
              type: array
              items:
                $ref: "#/components/schemas/PartnerPaymentOption"
            accounting:
              description: |
                Accounting data for structured invoices. For details about the
                properties see the description of the `invoice` property for
                [Send content](#tag/Tenant-API-Content/operation/Send%20content)
              type: object
              properties:
                invoice_type:
                  type: string
                  description: |
                    The type of invoice that the content was sent as. For details
                    about expected values, see the `accounting.*` variants allowed
                    for the content `type` property in
                    [Send content](#tag/Tenant-API-Content/operation/Send%20content)
                total_amount_due:
                  type: string
                currency:
                  type: string
                due_date:
                  type: string
                bankgiro:
                  type: string
                plusgiro:
                  type: string
                invoice_number:
                  type: string
                original_invoice_number:
                  type: string
                invoice_date:
                  type: string
                buyer_reference:
                  type: string
                order_number:
                  type: string
                supplier_name:
                  type: string
                supplier_organisation_number:
                  type: string
                supplier_vat_number:
                  type: string
                supplier_address_street:
                  type: string
                supplier_address_postal_code:
                  type: string
                supplier_address_city:
                  type: string
                payment_reference:
                  type: object
                iban:
                  type: string
                bic:
                  type: string
                total_amount_tax_exclusive:
                  type: string
                total_amount_tax_inclusive:
                  type: string
                total_vat_amount:
                  type: string
                rounding_amount:
                  type: string

            references:
              $ref: "#/components/schemas/InvoiceReferences"
            sender_contact_info:
              $ref: "#/components/schemas/SenderContactInfo"
          required:
            - interpreted_fields
            - key
            - labels
            - parts
            - payment_options
            - references
            - received_at
            - receiver_name
            - receiver_vat_number
            - sender_contact_info
            - sender_icon_url
            - sender_name
            - sender_vat_numbers
            - subject
            - transaction_at
            - type
        - $ref: "#/components/schemas/BaseContentMetadata"

    # ##############################################
    # SCHEMA PaymentCallbackDefinition
    # ##############################################
    PaymentCallbackDefinition:
      description: |
        A definition used to send webhooks from Kivra to a sender.
      type: object
      properties:
        id:
          description: The ID of the current webhook definition.
          type: string
          format: uuid
        url:
          description: |
            The target URL that Kivra will try to deliver to. The
            hostname in the URL must not be in a restricted domain
            (like for example `example.org` or `local`). The
            hostname also must resolve to at least one IPv4 address,
            and must not resolve to any addresses in an IPv4 range
            reserved by IANA.
          type: string
          format: url
        types:
          description: |
            A list of the types of payments that should trigger webhooks.
          type: array
          items:
            type: string
            enum:
              - instant
              - bank
              - autogiro
        events:
          description: |
            A list of the payment events that should trigger
            webhooks. Not all events are meaningful for all payment
            types.
          type: array
          items:
            type: string
            enum:
              - scheduled
              - settled
              - failed
        secret:
          description: |
            The newly created secret after a webhook definition was added or
            modified. The secret is a 256-bit random number that will be used to
            sign webhook payloads from Kivra. If a secret already exists when
            a new one is added (that is, when a webhook definition is modified
            rather han created), payloads will be signed with both the existing
            and the new secrets for the next 72 hours.
            For security reasons, the actual secret will be replaced with a
            dummy value in reponses to API calls that do not result in the
            creation of a new secret.
          type: string
          format: base64
        created_at:
          description: |
            The time when this definition was created.
          type: string
          format: date-time
        active:
          description: |
            A flag specifying if this definition is currently being
            used. Resonses for it not being used include the sender
            setting it to inactive, or a too large number of
            unsuccessful delivery attempts over a too long timeframe.

    # ##############################################
    # SCHEMA PaymentWebhookDefinition
    # ##############################################
    PaymentWebhookDefinition:
      description: |
        A definition used to send webhooks from Kivra to a sender.
      type: object
      properties:
        id:
          description: The ID of the current webhook definition.
          type: string
          format: uuid
        url:
          description: |
            The target URL that Kivra will try to deliver to. The
            hostname in the URL must not be in a restricted domain
            (like for example `example.org` or `local`). The
            hostname also must resolve to at least one IPv4 address,
            and must not resolve to any addresses in an IPv4 range
            reserved by IANA.
          type: string
          format: url
        cid_filter:
          description: |
            The client key filter for this webhook configuration.
          type: string
          pattern: '^[0-9]{10}[a-f0-9]{32}$'
        tkey_filter:
          description: |
            The tenant key filter for this webhook cofiguration.
          type: string
          pattern: '^[0-9]{10}[a-f0-9]{32}$'
        types:
          description: |
            A list of the types of payments that should trigger webhooks.
          type: array
          items:
            type: string
            enum:
              - instant
              - bank
              - autogiro
        events:
          description: |
            A list of the payment events that should trigger
            webhooks. Not all events are meaningful for all payment
            types.
          type: array
          items:
            type: string
            enum:
              - scheduled
              - settled
              - failed
        secret:
          description: |
            The newly created secret after a webhook definition was added or
            modified. The secret is a 256-bit random number that will be used to
            sign webhook payloads from Kivra. If a secret already exists when
            a new one is added (that is, when a webhook definition is modified
            rather han created), payloads will be signed with both the existing
            and the new secrets for the next 72 hours.
            For security reasons, this field will be missing in
            reponses to API calls that do not result in the creation
            of a new secret.
          type: string
          format: base64
        created_at:
          description: |
            The time when this definition was created.
          type: string
          format: date-time

    # ##############################################
    # SCHEMA Webhooks
    # ##############################################
    WebhookEventId:
      type: string
      description: Event ID prefixed with "event_". Can be used for deduplication.
      example: "event_3f62fc97907a4212af028c30f1ea1927"

    WebhookEventCreatedAt:
      type: integer
      format: int64
      description: Unix timestamp when the event happened, in seconds (UTC).
      example: 1686089970

  # ##############################################
  # SECURITY oAuth2Client
  # ##############################################

  securitySchemes:
    oAuth2Client:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: "https://sender.api.kivra.com/v1/auth"

webhooks:
  content.created:
    post:
      summary: Notification for new content
      operationId: webhook-content-created
      tags:
        - "Partner API v3"
      description: |
        This webhook notifies you when a company inbox receives new content.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - event_created_at
                - event_type
                - data_version
                - data
              properties:
                id:
                  $ref: "#/components/schemas/WebhookEventId"
                event_created_at:
                  $ref: "#/components/schemas/WebhookEventCreatedAt"
                event_type:
                  type: string
                  enum: ["content.created"]
                data_version:
                  type: integer
                  enum: [1]
                data:
                  type: object
                  required:
                    - company_key
                    - content_key
                    - vat_number
                  properties:
                    company_key:
                      $ref: "#/components/schemas/CompanyKey"
                    content_key:
                      $ref: "#/components/schemas/ContentKey"
                    vat_number:
                      pattern: ^SE[0-9]{10}01$
                      description: The VAT number of the company that received the content.
                      example: SE556000475501
                      type: string
      responses:
        200:
          description: >
            Return a 200 status to acknowledge receipt of the webhook.
            Any other response will cause Kivra to retry the delivery.
  integration.created:
    post:
      summary: Notification for partner integration activation
      operationId: webhook-integration-created
      tags:
        - "Partner API v3"
      description: |
        This webhook notifies you when a company has activated you as an integration partner, meaning you are allowed to use the Partner API on said company.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - event_created_at
                - event_type
                - data_version
                - data
              properties:
                id:
                  $ref: "#/components/schemas/WebhookEventId"
                event_created_at:
                  $ref: "#/components/schemas/WebhookEventCreatedAt"
                event_type:
                  type: string
                  enum: ["integration.created"]
                data_version:
                  type: integer
                  enum: [1]
                data:
                  type: object
                  required:
                    - company_key
                    - vat_number
                  properties:
                    company_key:
                      description: The key of the company that activated the integration.
                      pattern: ^[0-9]{10}[a-f0-9]{32}$
                      example: 156077433683911cdca5fd4563bded979572454cb9
                      type: string
                    vat_number:
                      pattern: ^SE[0-9]{10}01$
                      description: The VAT number of the company that activated the integration.
                      example: SE556000475501
                      type: string
      responses:
        200:
          description: >
            Return a 200 status to acknowledge receipt of the webhook.
            Any other response will cause Kivra to retry the delivery.
  integration.deleted:
    post:
      summary: Notification for partner integration deactivation
      operationId: webhook-integration-deleted
      tags:
        - "Partner API v3"
      description: |
        This webhook notifies you when a company has deactivated you as an integration partner, meaning you are no longer allowed to use the Partner API on said company.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - event_created_at
                - event_type
                - data_version
                - data
              properties:
                id:
                  $ref: "#/components/schemas/WebhookEventId"
                event_created_at:
                  $ref: "#/components/schemas/WebhookEventCreatedAt"
                event_type:
                  type: string
                  enum: ["integration.deleted"]
                data_version:
                  type: integer
                  enum: [1]
                data:
                  type: object
                  required:
                    - company_key
                    - vat_number
                  properties:
                    company_key:
                      description: The key of the company that deactivated the integration.
                      pattern: ^[0-9]{10}[a-f0-9]{32}$
                      example: 156077433683911cdca5fd4563bded979572454cb9
                      type: string
                    vat_number:
                      pattern: ^SE[0-9]{10}01$
                      description: The VAT number of the company that deactivated the integration.
                      example: SE556000475501
                      type: string
      responses:
        200:
          description: >
            Return a 200 status to acknowledge receipt of the webhook.
            Any other response will cause Kivra to retry the delivery.
  payment.webhook:
    post:
      summary: Payment webhook
      operationId: webhook-payment
      tags:
        - "Tenant API - Payment Webhooks"
      description: |
        This webhook notifies you when payment events occur such as when payments are settled,
        scheduled, or failed. Each webhook includes information about the payment including
        account details, amount, and event timing.

        ## Standard
        Kivra Payments follows [Standard Webhooks](https://standardwebhooks.com) for delivering webhooks.

        ## Authentication
        Kivra Payments signs webhooks with HMAC signatures that you can verify to ensure the request came from Kivra.
        When Kivra sends a webhook, the following headers will be included:

        - `webhook-id`: A unique identifier for the webhook delivery
        - `webhook-timestamp`: Unix timestamp when the webhook was sent
        - `webhook-signature`: Signature(s) used to verify the payload

        The signature header contains one or more signatures in the format:
        `v1,<signature1> v1a,<signature2>`

        The signature is generated by concatenating the following fields with a full stop between them:
        `msg_id.timestamp.payload`

        For instance:
        ```
        3f62fc97-907a-4212-af02-8c30f1ea1927.1674087231.{
          "type": "contact.created",
          "timestamp": "2022-11-03T20:26:10.344522Z",
          "data": {
            "id": "3f62fc97-907a-4212-af02-8c30f1ea1927"
          }
        }
        ```

        To verify the signature, use the raw body without any modification. Here are some examples on verification using the Standard Webhooks libraries:

        ```go
        // go
        import standardwebhooks "github.com/standard-webhooks/standard-webhooks/libraries/go"

        wh, err := standardwebhooks.NewWebhook(secret)
        wh.Verify(webhook.Body, webhook.Headers)
        ```

        ```java
        // java
        import com.standardwebhooks.Webhook;

        Webhook webhook = new Webhook(secret);
        webhook.verify(webhookBody, webhookHeaders);
        ```

        ```csharp
        // C#
        using StandardWebhooks;

        var wh = new Webhook(secret);
        wh.Verify(webhookBody, webhookHeaders);
        ```

        ## Retries

        Kivra Payments will retry delivery of the webhook in the case of a non-200 response. The schedule
        is as follows:

        Attempt | Delay | Time since start |
        | --- | --- | --- |
        | 1 | Immediately | 00:00:00 |
        | 2 | 5 seconds | 00:00:05 |
        | 3 | 5 minutes | 00:05:05 |
        | 4 | 30 minutes | 00:35:05 |
        | 5 | 2 hours | 02:35:05 |
        | 6 | 5 hours |	07:35:05 |
        | 7 | 10 hours | 17:35:05 |
        | 8 | 14 hours | 31:35:05 |
        | 9 | 20 hours | 51:35:05 |
        | 10 | 24 hours | 75:35:05 |

        If the delivery is unsuccessful on the 10th attempt, the delivery will be cancelled and no more attemps
        will be done.

      parameters:
        - name: webhook-id
          in: header
          required: true
          schema:
            type: string
            format: uuid
            example: "3f62fc97-907a-4212-af02-8c30f1ea1927"
          description: Unique identifier for this webhook delivery
        - name: webhook-timestamp
          in: header
          required: true
          schema:
            type: integer
            format: int64
            example: 1674087231
          description: Unix timestamp when the webhook was sent
        - name: webhook-signature
          in: header
          required: true
          schema:
            type: string
            example: "v1,K5oZfzN95Z9UVu1EsfQmfVNQhnkZ2pj9o9NDN/H/pI4= v1a,hnO3f9T8Ytu9HwrXslvumlUpqtNVqkhqw/enGzPCXe5BdqzCInXqYXFymVJaA7AZdpXwVLPo3mNl8EM+m7TBAg=="
          description: Signatures used to verify the webhook
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - timestamp
                - type
                - data
              properties:
                id:
                  type: string
                  format: uuid
                  description: Unique identifier for the webhook event
                  example: "3f62fc97-907a-4212-af02-8c30f1ea1927"
                timestamp:
                  type: string
                  format: date-time
                  description: Timestamp when the webhook was generated
                  example: "2025-04-24T13:45:10Z"
                type:
                  type: string
                  enum: ["payment_callback", "payment_callback_retry"]
                  description: Type of notification - original webhook or a retry
                data:
                  type: object
                  required:
                    - content_key
                    - payment_type
                    - payment_event
                    - event_time
                    - amount
                    - currency
                  properties:
                    content_key:
                      type: string
                      description: Key of the content associated with this payment
                      example: "1691677075a9813e08f783496382b0bff743ec34ae"
                    due_date:
                      type: string
                      format: date
                      description: Date when the payment was due
                      example: "2025-05-01"
                    pay_date:
                      type: string
                      format: date
                      description: Date when the payment was made
                      example: "2025-04-24"
                    destination_account_type:
                      type: string
                      enum: ["bankgiro", "plusgiro"]
                      description: Type of destination account
                    destination_account:
                      type: string
                      description: Destination account number
                      example: "12345-6789"
                    remittance_type:
                      type: string
                      enum: ["SE_OCR", "TENANT_REF"]
                      description: Type of remittance information
                    remittance_string:
                      type: string
                      description: Reference string used for the payment
                      example: "426523791"
                    option_title:
                      type: string
                      description: Title of the payment option if multiple options were available
                      example: "Full payment"
                    option_id:
                      type: string
                      description: Identifier of the selected payment option
                      example: "option_1"
                    payment_type:
                      type: string
                      enum: ["instant", "bank", "autogiro"]
                      description: Type of payment method used
                    payment_event:
                      type: string
                      enum: ["settled", "scheduled", "failed"]
                      description: The payment event that triggered this webhook
                    event_time:
                      type: string
                      format: date-time
                      description: Time when the payment event occurred
                      example: "2025-04-24T13:44:58Z"
                    swish_alias:
                      type: string
                      description: Swish alias used for the payment, if applicable
                      example: "1234567890"
                    swish_payment_reference:
                      type: string
                      description: Swish payment reference, if applicable
                      example: "652ED6A2BCDE4BA8AD11D7334E9567B7"
                    amount:
                      type: string
                      description: Payment amount as a string
                      example: "123.50"
                    currency:
                      type: string
                      description: Currency code for the payment
                      example: "SEK"
      responses:
        200:
          description: >
            Return a 200 status to acknowledge receipt of the webhook.
            Any other response will cause Kivra to retry the delivery,
            which will happen up to 10 times with increasing intervals.
